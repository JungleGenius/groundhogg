var inlineEditContact;window.wp=window.wp||{},function($,t,e,i){inlineEditContact={init:function(){var t=$("#inline-edit");this.type="contact",this.what="#contact-",t.keyup(function(t){if(27===t.which)return inlineEditContact.revert()}),$(".cancel",t).click(function(){return inlineEditContact.revert()}),$(".save",t).click(function(){return inlineEditContact.save(this)}),$("td",t).keydown(function(t){if(13===t.which&&!$(t.target).hasClass("cancel"))return inlineEditContact.save(this)}),$("#the-list").on("click","a.editinline",function(t){t.preventDefault(),inlineEditContact.edit(this)})},edit:function(t){var n,a,r,s=this;for(s.revert(),t=s.getId(t),n=["email","first_name","last_name","optin_status","owner"],a=$("#inline-edit").clone(!0),$("td",a).attr("colspan",$("th:visible, td:visible",".widefat:first thead").length),$(s.what+t).removeClass("is-expanded").hide().after(a).after('<tr class="hidden"></tr>'),r=$("#inline_"+t),f=0;f<n.length;f++)val=$("."+n[f],r),$(':input[name="'+n[f]+'"]',a).val(val.text());var d=$("#tags");return d.css("width","100%"),d.select2({tags:!0,multiple:!0,tokenSeparators:["/",",",";"],data:JSON.parse($(".tags-data",r).html()),ajax:{url:e.tags,dataType:"json",beforeSend:function(t){t.setRequestHeader("X-WP-Nonce",i._wprest)},results:function(t,e){return{results:t.results}}}}),d.val(JSON.parse($(".tags",r).html())),d.trigger("change"),$(a).attr("id","edit-"+t).addClass("inline-editor").show(),$(".cemail",a).focus(),!1},save:function(t){var e;return"object"==typeof t&&(t=this.getId(t)),$("table.widefat .spinner").addClass("is-active"),e={action:"wpgh_inline_save_contacts",ID:t},e=$("#edit-"+t).find(":input").serialize()+"&"+$.param(e),console.log(e),$.post(ajaxurl,e,function(e){var i=$("#edit-"+t+" .inline-edit-save .notice-error"),n=i.find(".error");$("table.widefat .spinner").removeClass("is-active"),$(".ac_results").hide(),e?-1!==e.indexOf("<tr")?($(inlineEditContact.what+t).siblings("tr.hidden").addBack().remove(),$("#edit-"+t).before(e).remove(),$(inlineEditContact.what+t).hide().fadeIn(400,function(){$(this).find(".editinline").focus()})):(e=e.replace(/<.[^<>]*?>/g,""),i.removeClass("hidden"),n.html(e)):(i.removeClass("hidden"),n.html(inlineEditL10n.error))},"html"),!1},revert:function(){var t=$(".widefat"),e=$(".inline-editor",t).attr("id");return e&&($(".spinner",t).removeClass("is-active"),$(".ac_results").hide(),$("#"+e).siblings("tr.hidden").addBack().remove(),e=e.substr(e.lastIndexOf("-")+1),$(this.what+e).show().find(".editinline").focus()),!1},getId:function(t){var e=$(t).closest("tr").attr("id").split("-");return e[e.length-1]}},$(document).ready(function(){inlineEditContact.init()})}(jQuery,window.wp,groundhogg_endpoints,groundhogg_nonces);