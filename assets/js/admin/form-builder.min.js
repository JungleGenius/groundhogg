var wpghFormBuilder;!function($){wpghFormBuilder={activeEditor:null,active:!1,currentType:null,types:{},init:function(){$(document).on("click","div.form-buttons",function(e){wpghFormBuilder.setup(this),wpghFormBuilder.getForm(e.target)}),$(".popup-save").click(function(e){wpghFormBuilder.active&&wpghFormBuilder.makeField()}),$("#field-name").change(function(){$(this).val(wpghFormBuilder.sanitizeKey($(this).val()))}),$("#field-id").change(function(){$(this).val(wpghFormBuilder.sanitizeKey($(this).val()))}),$("#gh-option-table").click(function(e){$(e.target).closest(".deletemeta").length&&$(e.target).closest("tr").remove()}),$("#btn-saveoption").click(function(){wpghFormBuilder.saveOptions()}),$(".addoption").click(function(){wpghFormBuilder.addOptionsHTML()}),this.initTypes()},saveOptions:function(){var e=new Array;$('input[name="option[]"]').each(function(){e.push($(this).val())});var t=new Array;$('select[name="tags[]"]').each(function(){t.push($(this).val())});var s="";for(i=0;i<e.length;i++)e[i]&&t[i]?s+=e[i].trim()+"|"+t[i]+"\n":e[i]&&(s+=e[i].trim()+"\n");$("#field-options").val(s.trim())},addOptionsHTML:function(){$("#gh-option-table").find("tbody").append("<tr><th><input type='text' class='input'  name='option[]' placeholder='Option Name'></th><td><select class='js-data-example-ajax' name='tags[]' style='min-width: 140px; '></select>"+' <span  class="row-actions"><span class="delete"><a style="text-decoration: none" href="javascript:void(0)" class="deletemeta"><span class="dashicons dashicons-trash"></span></a></span></span>\n</td></tr>'),$(".js-data-example-ajax").select2({ajax:{url:ajax_object.ajax_url,dataType:"json",data:{action:"wpgh_tags_list"}}})},initTypes:function(){this.types.first=["required","label","placeholder","id","class"],this.types.last=["required","label","placeholder","id","class"],this.types.email=["label","placeholder","id","class"],this.types.phone=["required","label","placeholder","id","class"],this.types.gdpr=["label","id","class"],this.types.terms=["label","id","class"],this.types.recaptcha=["captcha-theme","captcha-size","id","class"],this.types.submit=["text","id","class"],this.types.text=["required","label","placeholder","name","id","class"],this.types.textarea=["required","label","placeholder","name","id","class"],this.types.number=["required","label","name","min","max","id","class"],this.types.dropdown=["required","label","name","default","options","multiple","id","class"],this.types.radio=["required","label","name","options","id","class"],this.types.checkbox=["required","label","name","value","id","class"],this.types.address=["required","label","id","class"],this.types.row=["id","class"],this.types.col=["width","id","class"],this.types.date=["required","label","name","min_date","max_date","id","class"],this.types.time=["required","label","name","min_time","max_time","id","class"],this.types.file=["required","label","name","max_file_size","file_types","id","class"]},sanitizeKey:function(e){return e.toLowerCase().replace(/[^a-z0-9\-_]/g,"")},setup:function(e){this.activeEditor=$(e).closest(".form-editor").find(".code")[0]},getForm:function(e){wpghModal.args.preventSave=!0,this.active=!0,this.currentType=e.className.split(" ")[2];var t=this.types[this.currentType];this.hideFields(),this.showFields(t)},hideFields:function(){$(".form-field-form").find("tr").addClass("hidden")},showFields:function(e){for(var t=0;t<e.length;t++)$("#gh-field-"+e[t]).removeClass("hidden")},buildCode:function(){for(var e=$("#form-field-form"),t=e.serializeArray(),i="["+this.currentType,s=["col","row","gdpr","recaptcha","submit"],a=0;a<t.length;a++)this.types[this.currentType].includes(t[a].name)&&(""!==t[a].value?i+=" "+t[a].name+'="'+t[a].value.replace(/\r\n/g,"\n").replace(/\r/g,"\n").replace(/\n/g,",")+'"':"label"===t[a].name&&-1===s.indexOf(this.currentType)&&(i+=' label=""'));return i+="]","col"===this.currentType?i+="[/col]":"row"===this.currentType&&(i+="[/row]"),e.trigger("reset"),i},insert:function(e){var t=this.activeEditor;if(document.selection)t.focus(),sel=document.selection.createRange(),sel.text=e;else if(t.selectionStart){var i=t.selectionStart,s=t.selectionEnd;t.value=t.value.substring(0,i)+e+t.value.substring(s,t.value.length),t.selectionStart=i+e.length,t.selectionEnd=i+e.length}else t.value+=e},makeField:function(){var e=this.buildCode();this.insert(e),this.active=!1}},$(function(){wpghFormBuilder.init()})}(jQuery);