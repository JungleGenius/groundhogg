var wpghFormBuilder;!function($){wpghFormBuilder={activeEditor:null,active:!1,currentType:null,types:{},init:function(){$(document).on("click","div.form-buttons",function(e){wpghFormBuilder.setup(this),wpghFormBuilder.getForm(e.target)}),$(".popup-save").click(function(e){wpghFormBuilder.active&&wpghFormBuilder.makeField()}),$("#field-name").change(function(){$(this).val(wpghFormBuilder.sanitizeKey($(this).val()))}),$("#field-id").change(function(){$(this).val(wpghFormBuilder.sanitizeKey($(this).val()))}),this.initTypes()},initTypes:function(){this.types.first=["required","label","placeholder","id","class"],this.types.last=["required","label","placeholder","id","class"],this.types.email=["required","label","placeholder","id","class"],this.types.phone=["required","label","placeholder","id","class"],this.types.gdpr=["label","id","class"],this.types.terms=["label","id","class"],this.types.recaptcha=["captcha-theme","captcha-size","id","class"],this.types.submit=["text","id","class"],this.types.text=["required","label","placeholder","name","id","class"],this.types.extarea=["required","label","placeholder","name","id","class"],this.types.number=["required","label","name","min","max","id","class"],this.types.dropdown=["required","label","name","default","options","multiple","id","class"],this.types.radio=["required","label","name","options","id","class"],this.types.checkbox=["required","label","name","value","id","class"],this.types.address=["required","label","id","class"],this.types.row=["id","class"],this.types.col=["width","id","class"],this.types.date=["required","label","name","min-date","max-date","id","class"],this.types.time=["required","label","name","min-time","max-time","id","class"],this.types.file=["required","label","name","max-upload-size","file-types","id","class"]},sanitizeKey:function(e){return e.toLowerCase().replace(/[^a-z0-9\-_]/g,"")},setup:function(e){this.activeEditor=$(e).closest(".form-editor").find(".code")[0]},getForm:function(e){wpghModal.args.preventSave=!0,this.active=!0,this.currentType=e.className.split(" ")[2];var i=this.types[this.currentType];this.hideFields(),this.showFields(i)},hideFields:function(){$(".form-field-form").find("tr").addClass("hidden")},showFields:function(e){for(var i=0;i<e.length;i++)$("#gh-field-"+e[i]).removeClass("hidden")},buildCode:function(){for(var e=$("#form-field-form"),i=e.serializeArray(),t="["+this.currentType,s=["col","row","gdpr","recaptcha","submit"],l=0;l<i.length;l++)""!==i[l].value?t+=" "+i[l].name+'="'+i[l].value.replace(/\r\n/g,"\n").replace(/\r/g,"\n").replace(/\n/g,",")+'"':"label"===i[l].name&&-1===s.indexOf(this.currentType)&&(t+=' label=""');return-1===t.search("required")&&-1===s.indexOf(this.currentType)&&(t+=' required="false"'),t+="]","col"===this.currentType?t+="[/col]":"row"===this.currentType&&(t+="[/row]"),e.trigger("reset"),t},insert:function(e){var i=this.activeEditor;if(document.selection)i.focus(),sel=document.selection.createRange(),sel.text=e;else if(i.selectionStart){var t=i.selectionStart,s=i.selectionEnd;i.value=i.value.substring(0,t)+e+i.value.substring(s,i.value.length),i.selectionStart=t+e.length,i.selectionEnd=t+e.length}else i.value+=e},makeField:function(){var e=this.buildCode();this.insert(e),this.active=!1}},$(function(){wpghFormBuilder.init()})}(jQuery);