var wpghFormBuilder;!function($){wpghFormBuilder={activeEditor:null,active:!1,currentType:null,init:function(){$(document).on("click","div.form-buttons",function(e){wpghFormBuilder.setup(this),wpghFormBuilder.getForm(e.target)}),$(".popup-save").click(function(e){wpghFormBuilder.active&&wpghFormBuilder.makeField()}),$("#field-name").change(function(){$(this).val(wpghFormBuilder.sanitizeKey($(this).val()))}),$("#field-id").change(function(){$(this).val(wpghFormBuilder.sanitizeKey($(this).val()))})},sanitizeKey:function(e){return e.toLowerCase().replace(/[^a-z0-9\-_]/g,"")},setup:function(e){this.activeEditor=$(e).closest(".form-editor").find(".code")[0]},getForm:function(e){wpghModal.args.preventSave=!0,this.active=!0;var i=e.className.split(" ")[2],a=[];switch(this.currentType=i){case"first":case"last":case"email":case"phone":a=["required","label","placeholder","id","class"];break;case"gdpr":case"terms":a=["label","id","class"];break;case"recaptcha":a=["captcha-theme","captcha-size","id","class"];break;case"submit":a=["text","id","class"];break;case"text":case"textarea":a=["required","label","placeholder","name","id","class"];break;case"number":a=["required","label","name","min","max","id","class"];break;case"dropdown":a=["required","label","name","default","options","multiple","id","class"];break;case"radio":a=["required","label","name","options","id","class"];break;case"checkbox":a=["required","label","name","value","id","class"];break;case"address":a=["required","label","id","class"];break;case"row":a=["id","class"];break;case"col":a=["width","id","class"]}this.hideFields(),this.showFields(a)},hideFields:function(){$(".form-field-form").find("tr").addClass("hidden")},showFields:function(e){for(var i=0;i<e.length;i++)$("#gh-field-"+e[i]).removeClass("hidden")},buildCode:function(){for(var e=$("#form-field-form"),i=e.serializeArray(),a="["+this.currentType,r=["col","row","gdpr","recaptcha","submit"],t=0;t<i.length;t++)""!==i[t].value?a+=" "+i[t].name+'="'+i[t].value.replace(/\r\n/g,"\n").replace(/\r/g,"\n").replace(/\n/g,",")+'"':"label"===i[t].name&&-1===r.indexOf(this.currentType)&&(a+=' label=""');return-1===a.search("required")&&-1===r.indexOf(this.currentType)&&(a+=' required="false"'),a+="]","col"===this.currentType?a+="[/col]":"row"===this.currentType&&(a+="[/row]"),e.trigger("reset"),a},insert:function(e){var i=this.activeEditor;if(document.selection)i.focus(),sel=document.selection.createRange(),sel.text=e;else if(i.selectionStart){var a=i.selectionStart,r=i.selectionEnd;i.value=i.value.substring(0,a)+e+i.value.substring(r,i.value.length),i.selectionStart=a+e.length,i.selectionEnd=a+e.length}else i.value+=e},makeField:function(){var e=this.buildCode();this.insert(e),this.active=!1}},$(function(){wpghFormBuilder.init()})}(jQuery);