var wpghModal;!function($,t){wpghModal={overlay:null,window:null,content:null,title:null,source:null,frameUrl:"",args:{},init:function(t,e){this.args=this.getDefaults(),this.parseArgs(e),this.overlay=$(".popup-overlay"),this.window=$(".popup-window"),this.content=$(".popup-content"),this.title=$(".popup-title"),this.loader=$(".iframe-loader-wrapper");var i=new RegExp(/(https|http)?:\/\/((www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6})|(localhost)\b([-a-zA-Z0-9@:%_\+.~#?&\/=]*)/);this.sizeup(),this.args.source.match(i)?(this.loader.removeClass("hidden"),this.source=$("<div><iframe class='hidden' src='"+this.args.source+"' width='"+this.args.width+"' height='"+(this.args.height-100)+"' onload='wpghModal.prepareFrame( this )'></iframe></div>")):this.source=$("#"+this.args.source),this.title.text(t),void 0!==this.args.footer&&"false"===this.args.footer?$(".popup-footer").addClass("hidden"):$(".popup-footer").removeClass("hidden"),void 0!==this.args.footertext&&$(".popup-save").text(this.args.footertext)},parseArgs:function(t){var e=t.indexOf("#"),i=t.substring(e+1);i=i.split("&");for(var s=0;s<i.length;s++){var o=i[s].split("=");this.args[o[0]]=decodeURIComponent(o[1].replace("+"," "))}return this.args},sizeup:function(){var t=Math.max(document.documentElement.clientWidth,window.innerWidth||0),e=Math.max(document.documentElement.clientHeight,window.innerHeight||0);this.args.height>e&&(this.args.height=e-50),this.args.width>t&&(this.args.width=t-50),this.window.css("height",this.args.height+"px"),this.window.css("width",this.args.width+"px"),this.window.css("top","calc( 50% - "+this.args.height/2+"px )"),this.window.css("left","calc( 50% - "+this.args.width/2+"px )"),this.content.css("height",this.args.height-100+"px")},open:function(){this.pullContent(),this.showPopUp(),$(document).trigger("wpghModalOpened")},close:function(){this.pushContent(),this.hidePopUp(),void 0!==this.args.preventSave&&!1!==this.args.preventSave&&"false"!==this.args.preventSave||$(document).trigger("wpghModalClosed"),this.reset()},pullFrame:function(t){var e=$(t),i=$("#wpbody-content",e.contents());this.content.append(i)},prepareFrame:function(t){var e=$(t);this.content.removeClass("hidden"),this.content.css("padding",0),e.removeClass("hidden"),this.loader.addClass("hidden"),e.contents().find(".choose-template").click(function(){wpghModal.frameReload()})},frameReload:function(){this.content.addClass("hidden"),this.loader.removeClass("hidden")},pullContent:function(){this.content.append(this.source.children()),$(document).trigger("wpghModalContentPulled")},pushContent:function(){this.source.append(this.content.children()),$(document).trigger("wpghModalContentPushed")},showPopUp:function(){this.overlay.removeClass("hidden"),this.window.removeClass("hidden"),this.overlay.fadeIn(),this.window.fadeIn()},hidePopUp:function(){this.window.addClass("hidden"),this.overlay.addClass("hidden")},getDefaults:function(){return JSON.parse(JSON.stringify(t))},reset:function(){this.args=this.getDefaults(),this.content.css("padding","0 20px")},reload:function(){$(document).on("click",".trigger-popup",function(t){t.preventDefault(),wpghModal.init(this.title,this.href),$(this).hasClass("no-padding")&&$(".popup-content").css("padding","0"),wpghModal.open()}),$(document).on("click","#popup-close",function(){wpghModal.close()}),$(document).on("click",".popup-save",function(){wpghModal.close(),$(document).trigger("wpghModalSaved")})}},$(function(){wpghModal.reload(),$(".wpgh-color").wpColorPicker()}),$(document).on("wpghAddedStep",function(){$(".wpgh-color").wpColorPicker()})}(jQuery,wpghModalDefaults);