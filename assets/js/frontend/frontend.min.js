(function(gh){const{cookies_enabled:cookies_enabled,cookies:cookies,page_view_endpoint:page_view_endpoint,tracking_enabled:tracking_enabled,base_url:base_url,form_impression_endpoint:form_impression_endpoint}=gh;function apiPost(url="",data={},opts={}){return fetch(url,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":gh._wprest},body:JSON.stringify(data),...opts}).then(r=>r.json())}const DURATION={HOUR:60*60*1e3,MINUTE:60*1e3,DAY:24*60*60*1e3};const setCookie=(cname,cvalue,duration)=>{var d=new Date;d.setTime(d.getTime()+duration);var expires="expires="+d.toUTCString();document.cookie=cname+"="+cvalue+";"+expires+";path=/"};const getCookie=(cname,none=null)=>{var name=cname+"=";var ca=document.cookie.split(";");for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==" "){c=c.substring(1)}if(c.indexOf(name)==0){return c.substring(name.length,c.length)}}return none};const defaultPageTracking={pages:[],pagesAndTimes:[]};const getVisitedPages=()=>{return JSON.parse(getCookie("groundhogg-page-visits",JSON.stringify(defaultPageTracking)))};const rememberPageVisit=(wasTracked=false)=>{const url=new URL(window.location.href);const pagesVisited=getVisitedPages();pagesVisited.pages.push(url.pathname);pagesVisited.pagesAndTimes.push({page:url.href,time:Date.now()/1e3,tracked:wasTracked});setCookie("groundhogg-page-visits",JSON.stringify(pagesVisited),DURATION.HOUR)};gh={...gh,previousFormImpressions:[],pageView:function(){const url=new URL(window.location.href);if(cookies_enabled){if(getVisitedPages().pages.includes(url.pathname)){return}}if(this.isLoggedIn||this.hasContactTrackingCookie){apiPost(page_view_endpoint,{ref:url.href});rememberPageVisit(true)}else{rememberPageVisit(false)}},logFormImpressions:function(){var self=this;var forms=document.querySelectorAll(".gh-form");forms.forEach(function(form,i){var fId=form.querySelector('input[name="gh_submit_form"]').value;self.formImpression(fId)})},formImpression:function(id){if(!id||this.previousFormImpressions.indexOf(id)!==-1){return}apiPost(form_impression_endpoint,{ref:window.location.href,form_id:id}).then(()=>{this.previousFormImpressions.push(id);setCookie(cookies.form_impressions,this.previousFormImpressions.join(),3*DURATION.DAY)})},init:function(){this.hasContactTrackingCookie=getCookie(cookies.tracking)!==null;this.isLoggedIn=document.body.classList.contains("logged-in");if(cookies_enabled){var referer=getCookie(cookies.lead_source);if(!referer){setCookie(cookies.lead_source,document.referrer,3*DURATION.DAY)}this.previousFormImpressions=getCookie(cookies.form_impressions,"").split(",");this.logFormImpressions()}if(tracking_enabled){this.pageView()}}};window.addEventListener("load",()=>{gh.init()})})(Groundhogg);