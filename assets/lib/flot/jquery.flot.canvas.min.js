!function($){var t,e,i,n=Object.prototype.hasOwnProperty;$.plot.plugins.push({init:function(o,r){var s=r.Canvas;null==t&&(e=s.prototype.getTextInfo,i=s.prototype.addText,t=s.prototype.render),s.prototype.render=function(){if(!o.getOptions().canvas)return t.call(this);var e=this.context,i=this._textCache;for(var r in e.save(),e.textBaseline="middle",i)if(n.call(i,r)){var s=i[r];for(var a in s)if(n.call(s,a)){var l=s[a],h=!0;for(var f in l)if(n.call(l,f)){var p=l[f],c=p.positions,v=p.lines;h&&(e.fillStyle=p.font.color,e.font=p.font.definition,h=!1);for(var d,g=0;d=c[g];g++)if(d.active)for(var u,y=0;u=d.lines[y];y++)e.fillText(v[y].text,u[0],u[1]);else c.splice(g--,1);0==c.length&&delete l[f]}}}e.restore()},s.prototype.getTextInfo=function(t,i,n,r,s){if(!o.getOptions().canvas)return e.call(this,t,i,n,r,s);var a,l,h,f;if(i=""+i,a="object"==typeof n?n.style+" "+n.variant+" "+n.weight+" "+n.size+"px "+n.family:n,null==(l=this._textCache[t])&&(l=this._textCache[t]={}),null==(h=l[a])&&(h=l[a]={}),null==(f=h[i])){var p=this.context;if("object"!=typeof n){var c=$("<div>&nbsp;</div>").css("position","absolute").addClass("string"==typeof n?n:null).appendTo(this.getTextLayer(t));(n={lineHeight:c.height(),style:c.css("font-style"),variant:c.css("font-variant"),weight:c.css("font-weight"),family:c.css("font-family"),color:c.css("color")}).size=c.css("line-height",1).height(),c.remove()}a=n.style+" "+n.variant+" "+n.weight+" "+n.size+"px "+n.family,f=h[i]={width:0,height:0,positions:[],lines:[],font:{definition:a,color:n.color}},p.save(),p.font=a;for(var v=(i+"").replace(/<br ?\/?>|\r\n|\r/g,"\n").split("\n"),d=0;d<v.length;++d){var g=v[d],u=p.measureText(g);f.width=Math.max(u.width,f.width),f.height+=n.lineHeight,f.lines.push({text:g,width:u.width,height:n.lineHeight})}p.restore()}return f},s.prototype.addText=function(t,e,n,r,s,a,l,h,f){if(!o.getOptions().canvas)return i.call(this,t,e,n,r,s,a,l,h,f);var p,c=this.getTextInfo(t,r,s,a,l),v=c.positions,d=c.lines;n+=c.height/d.length/2,n="middle"==f?Math.round(n-c.height/2):"bottom"==f?Math.round(n-c.height):Math.round(n),window.opera&&window.opera.version().split(".")[0]<12&&(n-=2);for(var g,u=0;g=v[u];u++)if(g.x==e&&g.y==n)return void(g.active=!0);for(g={active:!0,lines:[],x:e,y:n},v.push(g),u=0;p=d[u];u++)"center"==h?g.lines.push([Math.round(e-p.width/2),n]):"right"==h?g.lines.push([Math.round(e-p.width),n]):g.lines.push([Math.round(e),n]),n+=p.height}},options:{canvas:!0},name:"canvas",version:"1.0"})}(jQuery);