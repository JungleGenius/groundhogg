{"version":3,"sources":["@wordpress/block-editor/src/components/inserter/menu.js"],"names":["useState","LEFT","RIGHT","UP","DOWN","BACKSPACE","ENTER","VisuallyHidden","__","useSelect","Tips","InserterSearchForm","InserterPreviewPanel","BlockTypesTab","BlockPatternsTabs","ReusableBlocksTab","useInsertionPoint","InserterTabs","stopKeyPropagation","event","stopPropagation","InserterMenu","rootClientId","clientId","isAppender","__experimentalSelectBlockOnInsert","onSelect","showInserterHelpPanel","showMostUsedBlocks","activeTab","setActiveTab","filterValue","setFilterValue","hoveredItem","setHoveredItem","selectedPatternCategory","setSelectedPatternCategory","selectBlockOnInsert","destinationRootClientId","onInsertBlocks","onToggleInsertionPoint","select","getSettings","__experimentalBlockPatterns","__experimentalReusableBlocks","hasPatterns","length","hasReusableBlocks","showPatterns","onKeyDown","includes","keyCode","onInsert","blocks","onInsertPattern","patternName","onHover","item","onClickPatternCategory","patternCategory","blocksTab","patternsTab","reusableBlocksTab","searchFormPlaceholder","value","tab","name"],"mappings":";;;AAAA;;;AAGA,SAASA,QAAT,QAAyB,oBAAzB;AACA,SAASC,IAAT,EAAeC,KAAf,EAAsBC,EAAtB,EAA0BC,IAA1B,EAAgCC,SAAhC,EAA2CC,KAA3C,QAAwD,qBAAxD;AACA,SAASC,cAAT,QAA+B,uBAA/B;AACA,SAASC,EAAT,QAAmB,iBAAnB;AACA,SAASC,SAAT,QAA0B,iBAA1B;AAEA;;;;AAGA,OAAOC,IAAP,MAAiB,QAAjB;AACA,OAAOC,kBAAP,MAA+B,eAA/B;AACA,OAAOC,oBAAP,MAAiC,iBAAjC;AACA,OAAOC,aAAP,MAA0B,mBAA1B;AACA,OAAOC,iBAAP,MAA8B,sBAA9B;AACA,OAAOC,iBAAP,MAA8B,uBAA9B;AACA,OAAOC,iBAAP,MAA8B,6BAA9B;AACA,OAAOC,YAAP,MAAyB,QAAzB;;AAEA,IAAMC,kBAAkB,GAAG,SAArBA,kBAAqB,CAAEC,KAAF;AAAA,SAAaA,KAAK,CAACC,eAAN,EAAb;AAAA,CAA3B;;AAEA,SAASC,YAAT,OAQI;AAAA,MAPHC,YAOG,QAPHA,YAOG;AAAA,MANHC,QAMG,QANHA,QAMG;AAAA,MALHC,UAKG,QALHA,UAKG;AAAA,MAJHC,iCAIG,QAJHA,iCAIG;AAAA,MAHHC,QAGG,QAHHA,QAGG;AAAA,MAFHC,qBAEG,QAFHA,qBAEG;AAAA,MADHC,kBACG,QADHA,kBACG;;AAAA,kBACiC5B,QAAQ,CAAE,QAAF,CADzC;AAAA;AAAA,MACK6B,SADL;AAAA,MACgBC,YADhB;;AAAA,mBAEqC9B,QAAQ,CAAE,EAAF,CAF7C;AAAA;AAAA,MAEK+B,WAFL;AAAA,MAEkBC,cAFlB;;AAAA,mBAGqChC,QAAQ,CAAE,IAAF,CAH7C;AAAA;AAAA,MAGKiC,WAHL;AAAA,MAGkBC,cAHlB;;AAAA,mBAI6DlC,QAAQ,CACvE,IADuE,CAJrE;AAAA;AAAA,MAIKmC,uBAJL;AAAA,MAI8BC,0BAJ9B;;AAAA,2BAYCpB,iBAAiB,CAAE;AACtBM,IAAAA,YAAY,EAAZA,YADsB;AAEtBC,IAAAA,QAAQ,EAARA,QAFsB;AAGtBC,IAAAA,UAAU,EAAVA,UAHsB;AAItBa,IAAAA,mBAAmB,EAAEZ;AAJC,GAAF,CAZlB;AAAA;AAAA,MASFa,uBATE;AAAA,MAUFC,cAVE;AAAA,MAWFC,sBAXE;;AAAA,mBAkBwC/B,SAAS,CAAE,UAAEgC,MAAF,EAAc;AAAA,8BAI/DA,MAAM,CAAE,mBAAF,CAAN,CAA8BC,WAA9B,EAJ+D;AAAA,QAElEC,2BAFkE,uBAElEA,2BAFkE;AAAA,QAGlEC,4BAHkE,uBAGlEA,4BAHkE;;AAMnE,WAAO;AACNC,MAAAA,WAAW,EAAE,CAAC,EAAEF,2BAAF,aAAEA,2BAAF,uBAAEA,2BAA2B,CAAEG,MAA/B,CADR;AAENC,MAAAA,iBAAiB,EAAE,CAAC,EAAEH,4BAAF,aAAEA,4BAAF,uBAAEA,4BAA4B,CAAEE,MAAhC;AAFd,KAAP;AAIA,GAVmD,EAUjD,EAViD,CAlBjD;AAAA,MAkBKD,WAlBL,cAkBKA,WAlBL;AAAA,MAkBkBE,iBAlBlB,cAkBkBA,iBAlBlB;;AA8BH,MAAMC,YAAY,GAAG,CAAEV,uBAAF,IAA6BO,WAAlD;;AAEA,MAAMI,SAAS,GAAG,SAAZA,SAAY,CAAE9B,KAAF,EAAa;AAC9B,QACC,CAAElB,IAAF,EAAQG,IAAR,EAAcF,KAAd,EAAqBC,EAArB,EAAyBE,SAAzB,EAAoCC,KAApC,EAA4C4C,QAA5C,CACC/B,KAAK,CAACgC,OADP,CADD,EAIE;AACD;AACAhC,MAAAA,KAAK,CAACC,eAAN;AACA;AACD,GATD;;AAWA,MAAMgC,QAAQ,GAAG,SAAXA,QAAW,CAAEC,MAAF,EAAc;AAC9Bd,IAAAA,cAAc,CAAEc,MAAF,CAAd;AACA3B,IAAAA,QAAQ;AACR,GAHD;;AAKA,MAAM4B,eAAe,GAAG,SAAlBA,eAAkB,CAAED,MAAF,EAAUE,WAAV,EAA2B;AAClDhB,IAAAA,cAAc,CAAEc,MAAF,EAAU;AAAEE,MAAAA,WAAW,EAAXA;AAAF,KAAV,CAAd;AACA7B,IAAAA,QAAQ;AACR,GAHD;;AAKA,MAAM8B,OAAO,GAAG,SAAVA,OAAU,CAAEC,IAAF,EAAY;AAC3BjB,IAAAA,sBAAsB,CAAE,CAAC,CAAEiB,IAAL,CAAtB;AACAvB,IAAAA,cAAc,CAAEuB,IAAF,CAAd;AACA,GAHD;;AAKA,MAAMC,sBAAsB,GAAG,SAAzBA,sBAAyB,CAAEC,eAAF,EAAuB;AACrDvB,IAAAA,0BAA0B,CAAEuB,eAAF,CAA1B;AACA,GAFD;;AAIA,MAAMC,SAAS,GACd,8BACC;AAAK,IAAA,SAAS,EAAC;AAAf,KACC,cAAC,aAAD;AACC,IAAA,YAAY,EAAGtB,uBADhB;AAEC,IAAA,QAAQ,EAAGc,QAFZ;AAGC,IAAA,OAAO,EAAGI,OAHX;AAIC,IAAA,WAAW,EAAGzB,WAJf;AAKC,IAAA,kBAAkB,EAAGH;AALtB,IADD,CADD,EAUGD,qBAAqB,IACtB;AAAK,IAAA,SAAS,EAAC;AAAf,KACC,cAAC,cAAD;AAAgB,IAAA,EAAE,EAAC;AAAnB,KACGnB,EAAE,CAAE,kCAAF,CADL,CADD,EAIC,cAAC,IAAD,OAJD,CAXF,CADD;AAsBA,MAAMqD,WAAW,GAChB,cAAC,iBAAD;AACC,IAAA,QAAQ,EAAGP,eADZ;AAEC,IAAA,WAAW,EAAGvB,WAFf;AAGC,IAAA,eAAe,EAAG2B,sBAHnB;AAIC,IAAA,gBAAgB,EAAGvB;AAJpB,IADD;AASA,MAAM2B,iBAAiB,GACtB,cAAC,iBAAD;AACC,IAAA,YAAY,EAAGxB,uBADhB;AAEC,IAAA,QAAQ,EAAGc,QAFZ;AAGC,IAAA,OAAO,EAAGI,OAHX;AAIC,IAAA,WAAW,EAAGzB;AAJf,IADD;;AASA,MAAMgC,qBAAqB,GAAG,SAAxBA,qBAAwB,GAAM;AACnC,QAAKlC,SAAS,KAAK,UAAnB,EAAgC;AAC/B,aAAOrB,EAAE,CAAE,6BAAF,CAAT;AACA;;AAED,QAAKqB,SAAS,KAAK,UAAnB,EAAgC;AAC/B,aAAOrB,EAAE,CAAE,sBAAF,CAAT;AACA;;AAED,WAAOA,EAAE,CAAE,oBAAF,CAAT;AACA,GAVD,CAtGG,CAkHH;AACA;AACA;AACA;AACA;;AACA;;;AACA,SACC;AACC,IAAA,SAAS,EAAC,6BADX;AAEC,IAAA,UAAU,EAAGU,kBAFd;AAGC,IAAA,SAAS,EAAG+B;AAHb,KAKC;AAAK,IAAA,SAAS,EAAC;AAAf,KAEC;AAAK,IAAA,SAAS,EAAC;AAAf,KACC,cAAC,kBAAD;AACC,IAAA,QAAQ,EAAG,kBAAEe,KAAF,EAAa;AACvB,UAAK/B,WAAL,EAAmBC,cAAc,CAAE,IAAF,CAAd;AACnBF,MAAAA,cAAc,CAAEgC,KAAF,CAAd;AACA,KAJF;AAKC,IAAA,KAAK,EAAGjC,WALT;AAMC,IAAA,WAAW,EAAGgC,qBAAqB;AANpC,IADD,EASG,CAAEf,YAAY,IAAID,iBAAlB,KACD,cAAC,YAAD;AACC,IAAA,YAAY,EAAGC,YADhB;AAEC,IAAA,kBAAkB,EAAGD,iBAFtB;AAGC,IAAA,QAAQ,EAAGjB;AAHZ,KAKG,UAAEmC,GAAF,EAAW;AACZ,QAAKA,GAAG,CAACC,IAAJ,KAAa,QAAlB,EAA6B;AAC5B,aAAON,SAAP;AACA,KAFD,MAEO,IAAKK,GAAG,CAACC,IAAJ,KAAa,UAAlB,EAA+B;AACrC,aAAOL,WAAP;AACA;;AACD,WAAOC,iBAAP;AACA,GAZF,CAVF,EAyBG,CAAEd,YAAF,IAAkB,CAAED,iBAApB,IAAyCa,SAzB5C,CAFD,CALD,EAmCGjC,qBAAqB,IAAIM,WAAzB,IACD,cAAC,oBAAD;AAAsB,IAAA,IAAI,EAAGA;AAA7B,IApCF,CADD;AAyCA;AACA;;AAED,eAAeZ,YAAf","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { useState } from '@wordpress/element';\nimport { LEFT, RIGHT, UP, DOWN, BACKSPACE, ENTER } from '@wordpress/keycodes';\nimport { VisuallyHidden } from '@wordpress/components';\nimport { __ } from '@wordpress/i18n';\nimport { useSelect } from '@wordpress/data';\n\n/**\n * Internal dependencies\n */\nimport Tips from './tips';\nimport InserterSearchForm from './search-form';\nimport InserterPreviewPanel from './preview-panel';\nimport BlockTypesTab from './block-types-tab';\nimport BlockPatternsTabs from './block-patterns-tab';\nimport ReusableBlocksTab from './reusable-blocks-tab';\nimport useInsertionPoint from './hooks/use-insertion-point';\nimport InserterTabs from './tabs';\n\nconst stopKeyPropagation = ( event ) => event.stopPropagation();\n\nfunction InserterMenu( {\n\trootClientId,\n\tclientId,\n\tisAppender,\n\t__experimentalSelectBlockOnInsert,\n\tonSelect,\n\tshowInserterHelpPanel,\n\tshowMostUsedBlocks,\n} ) {\n\tconst [ activeTab, setActiveTab ] = useState( 'blocks' );\n\tconst [ filterValue, setFilterValue ] = useState( '' );\n\tconst [ hoveredItem, setHoveredItem ] = useState( null );\n\tconst [ selectedPatternCategory, setSelectedPatternCategory ] = useState(\n\t\tnull\n\t);\n\n\tconst [\n\t\tdestinationRootClientId,\n\t\tonInsertBlocks,\n\t\tonToggleInsertionPoint,\n\t] = useInsertionPoint( {\n\t\trootClientId,\n\t\tclientId,\n\t\tisAppender,\n\t\tselectBlockOnInsert: __experimentalSelectBlockOnInsert,\n\t} );\n\tconst { hasPatterns, hasReusableBlocks } = useSelect( ( select ) => {\n\t\tconst {\n\t\t\t__experimentalBlockPatterns,\n\t\t\t__experimentalReusableBlocks,\n\t\t} = select( 'core/block-editor' ).getSettings();\n\n\t\treturn {\n\t\t\thasPatterns: !! __experimentalBlockPatterns?.length,\n\t\t\thasReusableBlocks: !! __experimentalReusableBlocks?.length,\n\t\t};\n\t}, [] );\n\n\tconst showPatterns = ! destinationRootClientId && hasPatterns;\n\n\tconst onKeyDown = ( event ) => {\n\t\tif (\n\t\t\t[ LEFT, DOWN, RIGHT, UP, BACKSPACE, ENTER ].includes(\n\t\t\t\tevent.keyCode\n\t\t\t)\n\t\t) {\n\t\t\t// Stop the key event from propagating up to ObserveTyping.startTypingInTextField.\n\t\t\tevent.stopPropagation();\n\t\t}\n\t};\n\n\tconst onInsert = ( blocks ) => {\n\t\tonInsertBlocks( blocks );\n\t\tonSelect();\n\t};\n\n\tconst onInsertPattern = ( blocks, patternName ) => {\n\t\tonInsertBlocks( blocks, { patternName } );\n\t\tonSelect();\n\t};\n\n\tconst onHover = ( item ) => {\n\t\tonToggleInsertionPoint( !! item );\n\t\tsetHoveredItem( item );\n\t};\n\n\tconst onClickPatternCategory = ( patternCategory ) => {\n\t\tsetSelectedPatternCategory( patternCategory );\n\t};\n\n\tconst blocksTab = (\n\t\t<>\n\t\t\t<div className=\"block-editor-inserter__block-list\">\n\t\t\t\t<BlockTypesTab\n\t\t\t\t\trootClientId={ destinationRootClientId }\n\t\t\t\t\tonInsert={ onInsert }\n\t\t\t\t\tonHover={ onHover }\n\t\t\t\t\tfilterValue={ filterValue }\n\t\t\t\t\tshowMostUsedBlocks={ showMostUsedBlocks }\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t{ showInserterHelpPanel && (\n\t\t\t\t<div className=\"block-editor-inserter__tips\">\n\t\t\t\t\t<VisuallyHidden as=\"h2\">\n\t\t\t\t\t\t{ __( 'A tip for using the block editor' ) }\n\t\t\t\t\t</VisuallyHidden>\n\t\t\t\t\t<Tips />\n\t\t\t\t</div>\n\t\t\t) }\n\t\t</>\n\t);\n\n\tconst patternsTab = (\n\t\t<BlockPatternsTabs\n\t\t\tonInsert={ onInsertPattern }\n\t\t\tfilterValue={ filterValue }\n\t\t\tonClickCategory={ onClickPatternCategory }\n\t\t\tselectedCategory={ selectedPatternCategory }\n\t\t/>\n\t);\n\n\tconst reusableBlocksTab = (\n\t\t<ReusableBlocksTab\n\t\t\trootClientId={ destinationRootClientId }\n\t\t\tonInsert={ onInsert }\n\t\t\tonHover={ onHover }\n\t\t\tfilterValue={ filterValue }\n\t\t/>\n\t);\n\n\tconst searchFormPlaceholder = () => {\n\t\tif ( activeTab === 'reusable' ) {\n\t\t\treturn __( 'Search for a reusable block' );\n\t\t}\n\n\t\tif ( activeTab === 'patterns' ) {\n\t\t\treturn __( 'Search for a pattern' );\n\t\t}\n\n\t\treturn __( 'Search for a block' );\n\t};\n\n\t// Disable reason (no-autofocus): The inserter menu is a modal display, not one which\n\t// is always visible, and one which already incurs this behavior of autoFocus via\n\t// Popover's focusOnMount.\n\t// Disable reason (no-static-element-interactions): Navigational key-presses within\n\t// the menu are prevented from triggering WritingFlow and ObserveTyping interactions.\n\t/* eslint-disable jsx-a11y/no-autofocus, jsx-a11y/no-static-element-interactions */\n\treturn (\n\t\t<div\n\t\t\tclassName=\"block-editor-inserter__menu\"\n\t\t\tonKeyPress={ stopKeyPropagation }\n\t\t\tonKeyDown={ onKeyDown }\n\t\t>\n\t\t\t<div className=\"block-editor-inserter__main-area\">\n\t\t\t\t{ /* the following div is necessary to fix the sticky position of the search form */ }\n\t\t\t\t<div className=\"block-editor-inserter__content\">\n\t\t\t\t\t<InserterSearchForm\n\t\t\t\t\t\tonChange={ ( value ) => {\n\t\t\t\t\t\t\tif ( hoveredItem ) setHoveredItem( null );\n\t\t\t\t\t\t\tsetFilterValue( value );\n\t\t\t\t\t\t} }\n\t\t\t\t\t\tvalue={ filterValue }\n\t\t\t\t\t\tplaceholder={ searchFormPlaceholder() }\n\t\t\t\t\t/>\n\t\t\t\t\t{ ( showPatterns || hasReusableBlocks ) && (\n\t\t\t\t\t\t<InserterTabs\n\t\t\t\t\t\t\tshowPatterns={ showPatterns }\n\t\t\t\t\t\t\tshowReusableBlocks={ hasReusableBlocks }\n\t\t\t\t\t\t\tonSelect={ setActiveTab }\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{ ( tab ) => {\n\t\t\t\t\t\t\t\tif ( tab.name === 'blocks' ) {\n\t\t\t\t\t\t\t\t\treturn blocksTab;\n\t\t\t\t\t\t\t\t} else if ( tab.name === 'patterns' ) {\n\t\t\t\t\t\t\t\t\treturn patternsTab;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\treturn reusableBlocksTab;\n\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t</InserterTabs>\n\t\t\t\t\t) }\n\t\t\t\t\t{ ! showPatterns && ! hasReusableBlocks && blocksTab }\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t{ showInserterHelpPanel && hoveredItem && (\n\t\t\t\t<InserterPreviewPanel item={ hoveredItem } />\n\t\t\t) }\n\t\t</div>\n\t);\n\t/* eslint-enable jsx-a11y/no-autofocus, jsx-a11y/no-static-element-interactions */\n}\n\nexport default InserterMenu;\n"]}