{"version":3,"sources":["@wordpress/block-editor/src/hooks/color.js"],"names":["classnames","isObject","addFilter","getBlockSupport","__","useRef","useEffect","Platform","createHigherOrderComponent","getColorClassName","getColorObjectByColorValue","getColorObjectByAttributeValues","__experimentalGetGradientClass","getGradientValueBySlug","getGradientSlugByValue","cleanEmptyObject","ColorPanel","useEditorFeature","COLOR_SUPPORT_KEY","EMPTY_ARRAY","hasColorSupport","blockType","OS","colorSupport","linkColor","gradient","background","text","hasLinkColorSupport","hasGradientSupport","gradients","hasBackgroundColorSupport","hasTextColorSupport","addAttributes","settings","attributes","backgroundColor","Object","assign","type","textColor","addSaveProps","props","hasGradient","style","backgroundClass","gradientClass","textClass","newClassName","className","color","link","undefined","addEditProps","existingGetEditWrapperProps","getEditWrapperProps","getLinkColorFromAttributeValue","colors","value","attributeParsed","exec","ColorEdit","blockName","name","isLinkColorEnabled","localAttributes","current","hasBackground","gradientValue","onChangeColor","colorObject","attributeName","newStyle","slug","newNamedColor","newAttributes","setAttributes","onChangeGradient","onChangeLinkColor","clientId","label","onColorChange","colorValue","onGradientChange","clearable","withColorPaletteStyles","BlockListBlock","extraStyles","wrapperProps"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport classnames from 'classnames';\nimport { isObject } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { addFilter } from '@wordpress/hooks';\nimport { getBlockSupport } from '@wordpress/blocks';\nimport { __ } from '@wordpress/i18n';\nimport { useRef, useEffect, Platform } from '@wordpress/element';\nimport { createHigherOrderComponent } from '@wordpress/compose';\n\n/**\n * Internal dependencies\n */\nimport {\n\tgetColorClassName,\n\tgetColorObjectByColorValue,\n\tgetColorObjectByAttributeValues,\n} from '../components/colors';\nimport {\n\t__experimentalGetGradientClass,\n\tgetGradientValueBySlug,\n\tgetGradientSlugByValue,\n} from '../components/gradients';\nimport { cleanEmptyObject } from './utils';\nimport ColorPanel from './color-panel';\nimport useEditorFeature from '../components/use-editor-feature';\n\nexport const COLOR_SUPPORT_KEY = '__experimentalColor';\nconst EMPTY_ARRAY = [];\n\nconst hasColorSupport = ( blockType ) => {\n\tif ( Platform.OS !== 'web' ) {\n\t\treturn false;\n\t}\n\tconst colorSupport = getBlockSupport( blockType, COLOR_SUPPORT_KEY );\n\treturn (\n\t\tcolorSupport &&\n\t\t( colorSupport.linkColor === true ||\n\t\t\tcolorSupport.gradient === true ||\n\t\t\tcolorSupport.background !== false ||\n\t\t\tcolorSupport.text !== false )\n\t);\n};\n\nconst hasLinkColorSupport = ( blockType ) => {\n\tif ( Platform.OS !== 'web' ) {\n\t\treturn false;\n\t}\n\n\tconst colorSupport = getBlockSupport( blockType, COLOR_SUPPORT_KEY );\n\n\treturn isObject( colorSupport ) && !! colorSupport.linkColor;\n};\n\nconst hasGradientSupport = ( blockType ) => {\n\tif ( Platform.OS !== 'web' ) {\n\t\treturn false;\n\t}\n\n\tconst colorSupport = getBlockSupport( blockType, COLOR_SUPPORT_KEY );\n\n\treturn isObject( colorSupport ) && !! colorSupport.gradients;\n};\n\nconst hasBackgroundColorSupport = ( blockType ) => {\n\tif ( Platform.OS !== 'web' ) {\n\t\treturn false;\n\t}\n\n\tconst colorSupport = getBlockSupport( blockType, COLOR_SUPPORT_KEY );\n\n\treturn colorSupport && colorSupport.background !== false;\n};\n\nconst hasTextColorSupport = ( blockType ) => {\n\tif ( Platform.OS !== 'web' ) {\n\t\treturn false;\n\t}\n\n\tconst colorSupport = getBlockSupport( blockType, COLOR_SUPPORT_KEY );\n\n\treturn colorSupport && colorSupport.text !== false;\n};\n\n/**\n * Filters registered block settings, extending attributes to include\n * `backgroundColor` and `textColor` attribute.\n *\n * @param  {Object} settings Original block settings\n * @return {Object}          Filtered block settings\n */\nfunction addAttributes( settings ) {\n\tif ( ! hasColorSupport( settings ) ) {\n\t\treturn settings;\n\t}\n\n\t// allow blocks to specify their own attribute definition with default values if needed.\n\tif ( ! settings.attributes.backgroundColor ) {\n\t\tObject.assign( settings.attributes, {\n\t\t\tbackgroundColor: {\n\t\t\t\ttype: 'string',\n\t\t\t},\n\t\t} );\n\t}\n\tif ( ! settings.attributes.textColor ) {\n\t\tObject.assign( settings.attributes, {\n\t\t\ttextColor: {\n\t\t\t\ttype: 'string',\n\t\t\t},\n\t\t} );\n\t}\n\n\tif ( hasGradientSupport( settings ) && ! settings.attributes.gradient ) {\n\t\tObject.assign( settings.attributes, {\n\t\t\tgradient: {\n\t\t\t\ttype: 'string',\n\t\t\t},\n\t\t} );\n\t}\n\n\treturn settings;\n}\n\n/**\n * Override props assigned to save component to inject colors classnames.\n *\n * @param  {Object} props      Additional props applied to save element\n * @param  {Object} blockType  Block type\n * @param  {Object} attributes Block attributes\n * @return {Object}            Filtered props applied to save element\n */\nexport function addSaveProps( props, blockType, attributes ) {\n\tif ( ! hasColorSupport( blockType ) ) {\n\t\treturn props;\n\t}\n\n\tconst hasGradient = hasGradientSupport( blockType );\n\n\t// I'd have prefered to avoid the \"style\" attribute usage here\n\tconst { backgroundColor, textColor, gradient, style } = attributes;\n\n\tconst backgroundClass = getColorClassName(\n\t\t'background-color',\n\t\tbackgroundColor\n\t);\n\tconst gradientClass = __experimentalGetGradientClass( gradient );\n\tconst textClass = getColorClassName( 'color', textColor );\n\tconst newClassName = classnames(\n\t\tprops.className,\n\t\ttextClass,\n\t\tgradientClass,\n\t\t{\n\t\t\t// Don't apply the background class if there's a custom gradient\n\t\t\t[ backgroundClass ]:\n\t\t\t\t( ! hasGradient || ! style?.color?.gradient ) &&\n\t\t\t\t!! backgroundClass,\n\t\t\t'has-text-color': textColor || style?.color?.text,\n\t\t\t'has-background':\n\t\t\t\tbackgroundColor ||\n\t\t\t\tstyle?.color?.background ||\n\t\t\t\t( hasGradient && ( gradient || style?.color?.gradient ) ),\n\t\t\t'has-link-color': style?.color?.link,\n\t\t}\n\t);\n\tprops.className = newClassName ? newClassName : undefined;\n\n\treturn props;\n}\n\n/**\n * Filters registered block settings to extand the block edit wrapper\n * to apply the desired styles and classnames properly.\n *\n * @param  {Object} settings Original block settings\n * @return {Object}          Filtered block settings\n */\nexport function addEditProps( settings ) {\n\tif ( ! hasColorSupport( settings ) ) {\n\t\treturn settings;\n\t}\n\tconst existingGetEditWrapperProps = settings.getEditWrapperProps;\n\tsettings.getEditWrapperProps = ( attributes ) => {\n\t\tlet props = {};\n\t\tif ( existingGetEditWrapperProps ) {\n\t\t\tprops = existingGetEditWrapperProps( attributes );\n\t\t}\n\t\treturn addSaveProps( props, settings, attributes );\n\t};\n\n\treturn settings;\n}\n\nconst getLinkColorFromAttributeValue = ( colors, value ) => {\n\tconst attributeParsed = /var:preset\\|color\\|(.+)/.exec( value );\n\tif ( attributeParsed && attributeParsed[ 1 ] ) {\n\t\treturn getColorObjectByAttributeValues( colors, attributeParsed[ 1 ] )\n\t\t\t.color;\n\t}\n\treturn value;\n};\n\n/**\n * Inspector control panel containing the color related configuration\n *\n * @param {Object} props\n *\n * @return {WPElement} Color edit element.\n */\nexport function ColorEdit( props ) {\n\tconst { name: blockName, attributes } = props;\n\tconst isLinkColorEnabled = useEditorFeature( 'color.link' );\n\tconst colors = useEditorFeature( 'color.palette' ) || EMPTY_ARRAY;\n\tconst gradients = useEditorFeature( 'color.gradients' ) || EMPTY_ARRAY;\n\n\t// Shouldn't be needed but right now the ColorGradientsPanel\n\t// can trigger both onChangeColor and onChangeBackground\n\t// synchronously causing our two callbacks to override changes\n\t// from each other.\n\tconst localAttributes = useRef( attributes );\n\tuseEffect( () => {\n\t\tlocalAttributes.current = attributes;\n\t}, [ attributes ] );\n\n\tif ( ! hasColorSupport( blockName ) ) {\n\t\treturn null;\n\t}\n\n\tconst hasBackground = hasBackgroundColorSupport( blockName );\n\tconst hasGradient = hasGradientSupport( blockName );\n\n\tconst { style, textColor, backgroundColor, gradient } = attributes;\n\tlet gradientValue;\n\tif ( hasGradient && gradient ) {\n\t\tgradientValue = getGradientValueBySlug( gradients, gradient );\n\t} else if ( hasGradient ) {\n\t\tgradientValue = style?.color?.gradient;\n\t}\n\n\tconst onChangeColor = ( name ) => ( value ) => {\n\t\tconst colorObject = getColorObjectByColorValue( colors, value );\n\t\tconst attributeName = name + 'Color';\n\t\tconst newStyle = {\n\t\t\t...localAttributes.current.style,\n\t\t\tcolor: {\n\t\t\t\t...localAttributes.current?.style?.color,\n\t\t\t\t[ name ]: colorObject?.slug ? undefined : value,\n\t\t\t},\n\t\t};\n\n\t\tconst newNamedColor = colorObject?.slug ? colorObject.slug : undefined;\n\t\tconst newAttributes = {\n\t\t\tstyle: cleanEmptyObject( newStyle ),\n\t\t\t[ attributeName ]: newNamedColor,\n\t\t};\n\n\t\tprops.setAttributes( newAttributes );\n\t\tlocalAttributes.current = {\n\t\t\t...localAttributes.current,\n\t\t\t...newAttributes,\n\t\t};\n\t};\n\n\tconst onChangeGradient = ( value ) => {\n\t\tconst slug = getGradientSlugByValue( gradients, value );\n\t\tlet newAttributes;\n\t\tif ( slug ) {\n\t\t\tconst newStyle = {\n\t\t\t\t...localAttributes.current?.style,\n\t\t\t\tcolor: {\n\t\t\t\t\t...localAttributes.current?.style?.color,\n\t\t\t\t\tgradient: undefined,\n\t\t\t\t},\n\t\t\t};\n\t\t\tnewAttributes = {\n\t\t\t\tstyle: cleanEmptyObject( newStyle ),\n\t\t\t\tgradient: slug,\n\t\t\t};\n\t\t} else {\n\t\t\tconst newStyle = {\n\t\t\t\t...localAttributes.current?.style,\n\t\t\t\tcolor: {\n\t\t\t\t\t...localAttributes.current?.style?.color,\n\t\t\t\t\tgradient: value,\n\t\t\t\t},\n\t\t\t};\n\t\t\tnewAttributes = {\n\t\t\t\tstyle: cleanEmptyObject( newStyle ),\n\t\t\t\tgradient: undefined,\n\t\t\t};\n\t\t}\n\t\tprops.setAttributes( newAttributes );\n\t\tlocalAttributes.current = {\n\t\t\t...localAttributes.current,\n\t\t\t...newAttributes,\n\t\t};\n\t};\n\n\tconst onChangeLinkColor = ( value ) => {\n\t\tconst colorObject = getColorObjectByColorValue( colors, value );\n\t\tprops.setAttributes( {\n\t\t\tstyle: {\n\t\t\t\t...props.attributes.style,\n\t\t\t\tcolor: {\n\t\t\t\t\t...props.attributes.style?.color,\n\t\t\t\t\tlink: colorObject?.slug\n\t\t\t\t\t\t? `var:preset|color|${ colorObject.slug }`\n\t\t\t\t\t\t: value,\n\t\t\t\t},\n\t\t\t},\n\t\t} );\n\t};\n\n\treturn (\n\t\t<ColorPanel\n\t\t\tenableContrastChecking={\n\t\t\t\t// Turn on contrast checker for web only since it's not supported on mobile yet.\n\t\t\t\tPlatform.OS === 'web' && ! gradient && ! style?.color?.gradient\n\t\t\t}\n\t\t\tclientId={ props.clientId }\n\t\t\tsettings={ [\n\t\t\t\t...( hasTextColorSupport( blockName )\n\t\t\t\t\t? [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlabel: __( 'Text Color' ),\n\t\t\t\t\t\t\t\tonColorChange: onChangeColor( 'text' ),\n\t\t\t\t\t\t\t\tcolorValue: getColorObjectByAttributeValues(\n\t\t\t\t\t\t\t\t\tcolors,\n\t\t\t\t\t\t\t\t\ttextColor,\n\t\t\t\t\t\t\t\t\tstyle?.color?.text\n\t\t\t\t\t\t\t\t).color,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t  ]\n\t\t\t\t\t: [] ),\n\t\t\t\t...( hasBackground || hasGradient\n\t\t\t\t\t? [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlabel: __( 'Background Color' ),\n\t\t\t\t\t\t\t\tonColorChange: hasBackground\n\t\t\t\t\t\t\t\t\t? onChangeColor( 'background' )\n\t\t\t\t\t\t\t\t\t: undefined,\n\t\t\t\t\t\t\t\tcolorValue: getColorObjectByAttributeValues(\n\t\t\t\t\t\t\t\t\tcolors,\n\t\t\t\t\t\t\t\t\tbackgroundColor,\n\t\t\t\t\t\t\t\t\tstyle?.color?.background\n\t\t\t\t\t\t\t\t).color,\n\t\t\t\t\t\t\t\tgradientValue,\n\t\t\t\t\t\t\t\tonGradientChange: hasGradient\n\t\t\t\t\t\t\t\t\t? onChangeGradient\n\t\t\t\t\t\t\t\t\t: undefined,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t  ]\n\t\t\t\t\t: [] ),\n\t\t\t\t...( isLinkColorEnabled && hasLinkColorSupport( blockName )\n\t\t\t\t\t? [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlabel: __( 'Link Color' ),\n\t\t\t\t\t\t\t\tonColorChange: onChangeLinkColor,\n\t\t\t\t\t\t\t\tcolorValue: getLinkColorFromAttributeValue(\n\t\t\t\t\t\t\t\t\tcolors,\n\t\t\t\t\t\t\t\t\tstyle?.color?.link\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\tclearable: !! props.attributes.style?.color\n\t\t\t\t\t\t\t\t\t?.link,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t  ]\n\t\t\t\t\t: [] ),\n\t\t\t] }\n\t\t/>\n\t);\n}\n\n/**\n * This adds inline styles for color palette colors.\n * Ideally, this is not needed and themes should load their palettes on the editor.\n *\n * @param  {Function} BlockListBlock Original component\n * @return {Function}                Wrapped component\n */\nexport const withColorPaletteStyles = createHigherOrderComponent(\n\t( BlockListBlock ) => ( props ) => {\n\t\tconst { name, attributes } = props;\n\t\tconst { backgroundColor, textColor } = attributes;\n\t\tconst colors = useEditorFeature( 'color.palette' ) || EMPTY_ARRAY;\n\t\tif ( ! hasColorSupport( name ) ) {\n\t\t\treturn <BlockListBlock { ...props } />;\n\t\t}\n\n\t\tconst extraStyles = {\n\t\t\tcolor: textColor\n\t\t\t\t? getColorObjectByAttributeValues( colors, textColor )?.color\n\t\t\t\t: undefined,\n\t\t\tbackgroundColor: backgroundColor\n\t\t\t\t? getColorObjectByAttributeValues( colors, backgroundColor )\n\t\t\t\t\t\t?.color\n\t\t\t\t: undefined,\n\t\t};\n\n\t\tlet wrapperProps = props.wrapperProps;\n\t\twrapperProps = {\n\t\t\t...props.wrapperProps,\n\t\t\tstyle: {\n\t\t\t\t...extraStyles,\n\t\t\t\t...props.wrapperProps?.style,\n\t\t\t},\n\t\t};\n\n\t\treturn <BlockListBlock { ...props } wrapperProps={ wrapperProps } />;\n\t}\n);\n\naddFilter(\n\t'blocks.registerBlockType',\n\t'core/color/addAttribute',\n\taddAttributes\n);\n\naddFilter(\n\t'blocks.getSaveContent.extraProps',\n\t'core/color/addSaveProps',\n\taddSaveProps\n);\n\naddFilter(\n\t'blocks.registerBlockType',\n\t'core/color/addEditProps',\n\taddEditProps\n);\n\naddFilter(\n\t'editor.BlockListBlock',\n\t'core/color/with-color-palette-styles',\n\twithColorPaletteStyles\n);\n"]}