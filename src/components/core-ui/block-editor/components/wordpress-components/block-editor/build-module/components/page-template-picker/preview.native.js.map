{"version":3,"sources":["@wordpress/block-editor/src/components/page-template-picker/preview.native.js"],"names":["BlockEditorProvider","BlockList","ModalHeaderBar","usePreferredColorSchemeStyle","useSelect","useEffect","useRef","__","subscribeAndroidModalClosed","Modal","Platform","View","SafeAreaView","styles","BlockPreview","blocks","currentSettings","select","getSettings","settings","readOnly","header","previewHeader","flex","displayName","ModalPreview","props","template","onDismiss","onApply","previewContainerStyle","previewContainer","previewContainerDark","androidModalClosedSubscription","OS","current","remove","undefined","leftButton","rightButton","name","Preview","previewContentStyle","previewContent","previewContentDark"],"mappings":"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","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { BlockEditorProvider, BlockList } from '@wordpress/block-editor';\nimport { ModalHeaderBar } from '@wordpress/components';\nimport { usePreferredColorSchemeStyle } from '@wordpress/compose';\nimport { useSelect } from '@wordpress/data';\nimport { useEffect, useRef } from '@wordpress/element';\nimport { __ } from '@wordpress/i18n';\nimport { subscribeAndroidModalClosed } from '@wordpress/react-native-bridge';\n\n/**\n * External dependencies\n */\nimport { Modal, Platform, View, SafeAreaView } from 'react-native';\n\n/**\n * Internal dependencies\n */\nimport styles from './styles.scss';\n\n// We are replicating this here because the one in @wordpress/block-editor always\n// tries to scale the preview and we would need a lot of cross platform code to handle\n// sizes, when we actually want to show the preview at full width.\n//\n// We can make it work here first, then figure out the right way to consolidate\n// both implementations\nconst BlockPreview = ( { blocks } ) => {\n\tconst currentSettings = useSelect( ( select ) => {\n\t\treturn select( 'core/block-editor' ).getSettings();\n\t} );\n\tconst settings = {\n\t\t...currentSettings,\n\t\treadOnly: true,\n\t};\n\n\tconst header = <View style={ styles.previewHeader } />;\n\n\treturn (\n\t\t<BlockEditorProvider value={ blocks } settings={ settings }>\n\t\t\t<View style={ { flex: 1 } }>\n\t\t\t\t<BlockList header={ header } />\n\t\t\t</View>\n\t\t</BlockEditorProvider>\n\t);\n};\nBlockPreview.displayName = 'BlockPreview';\n\nconst ModalPreview = ( props ) => {\n\tconst { template, onDismiss, onApply } = props;\n\tconst previewContainerStyle = usePreferredColorSchemeStyle(\n\t\tstyles.previewContainer,\n\t\tstyles.previewContainerDark\n\t);\n\tconst androidModalClosedSubscription = useRef();\n\n\tuseEffect( () => {\n\t\tif ( Platform.OS === 'android' ) {\n\t\t\tandroidModalClosedSubscription.current = subscribeAndroidModalClosed(\n\t\t\t\t() => {\n\t\t\t\t\tonDismiss();\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\treturn () => {\n\t\t\tif (\n\t\t\t\tandroidModalClosedSubscription &&\n\t\t\t\tandroidModalClosedSubscription.current\n\t\t\t) {\n\t\t\t\tandroidModalClosedSubscription.current.remove();\n\t\t\t}\n\t\t};\n\t}, [] );\n\n\tif ( template === undefined ) {\n\t\treturn null;\n\t}\n\n\tconst leftButton = <ModalHeaderBar.CloseButton onPress={ onDismiss } />;\n\n\tconst rightButton = (\n\t\t<ModalHeaderBar.Button\n\t\t\tonPress={ onApply }\n\t\t\ttitle={ __( 'Apply' ) }\n\t\t\tisPrimary={ true }\n\t\t/>\n\t);\n\n\treturn (\n\t\t<Modal\n\t\t\tvisible={ !! template }\n\t\t\tanimationType=\"slide\"\n\t\t\tonRequestClose={ onDismiss }\n\t\t\tsupportedOrientations={ [ 'portrait', 'landscape' ] }\n\t\t>\n\t\t\t<SafeAreaView style={ previewContainerStyle }>\n\t\t\t\t<ModalHeaderBar\n\t\t\t\t\tleftButton={ leftButton }\n\t\t\t\t\trightButton={ rightButton }\n\t\t\t\t\ttitle={ template.name }\n\t\t\t\t\tsubtitle={ __( 'Template Preview' ) }\n\t\t\t\t/>\n\t\t\t\t<Preview blocks={ template.blocks } />\n\t\t\t</SafeAreaView>\n\t\t</Modal>\n\t);\n};\nModalPreview.displayName = 'TemplatePreview';\n\nexport const Preview = ( props ) => {\n\tconst { blocks } = props;\n\tconst previewContentStyle = usePreferredColorSchemeStyle(\n\t\tstyles.previewContent,\n\t\tstyles.previewContentDark\n\t);\n\n\tif ( blocks === undefined ) {\n\t\treturn null;\n\t}\n\treturn (\n\t\t<View style={ previewContentStyle }>\n\t\t\t<BlockPreview blocks={ blocks } />\n\t\t</View>\n\t);\n};\n\nexport default ModalPreview;\n"]}