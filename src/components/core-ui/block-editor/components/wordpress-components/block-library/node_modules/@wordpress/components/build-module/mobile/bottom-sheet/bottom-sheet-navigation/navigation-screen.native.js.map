{"version":3,"sources":["@wordpress/components/src/mobile/bottom-sheet/bottom-sheet-navigation/navigation-screen.native.js"],"names":["useIsFocused","useNavigation","useFocusEffect","View","debounce","BottomSheetContext","useRef","useCallback","useContext","useMemo","BottomSheetNavigationContext","BottomSheetNavigationScreen","children","fullScreen","navigation","heightRef","maxHeight","isFocused","onHandleHardwareButtonPress","shouldEnableBottomSheetMaxHeight","setIsFullScreen","setHeight","setHeightDebounce","canGoBack","goBack","current","onLayout","nativeEvent","height","layout"],"mappings":";;AAAA;;;AAGA,SACCA,YADD,EAECC,aAFD,EAGCC,cAHD,QAIO,0BAJP;AAKA,SAASC,IAAT,QAAqB,cAArB;AACA,SAASC,QAAT,QAAyB,QAAzB;AAEA;;;;AAGA,SAASC,kBAAT,QAAmC,uBAAnC;AAEA,SAASC,MAAT,EAAiBC,WAAjB,EAA8BC,UAA9B,EAA0CC,OAA1C,QAAyD,oBAAzD;AAEA;;;;AAGA,SAASC,4BAAT,QAA6C,mCAA7C;;AAEA,IAAMC,2BAA2B,GAAG,SAA9BA,2BAA8B,OAAgC;AAAA,MAA5BC,QAA4B,QAA5BA,QAA4B;AAAA,MAAlBC,UAAkB,QAAlBA,UAAkB;AACnE,MAAMC,UAAU,GAAGb,aAAa,EAAhC;AACA,MAAMc,SAAS,GAAGT,MAAM,CAAE;AAAEU,IAAAA,SAAS,EAAE;AAAb,GAAF,CAAxB;AACA,MAAMC,SAAS,GAAGjB,YAAY,EAA9B;;AAHmE,oBAQ/DQ,UAAU,CAAEH,kBAAF,CARqD;AAAA,MAKlEa,2BALkE,eAKlEA,2BALkE;AAAA,MAMlEC,gCANkE,eAMlEA,gCANkE;AAAA,MAOlEC,eAPkE,eAOlEA,eAPkE;;AAAA,qBAU7CZ,UAAU,CAAEE,4BAAF,CAVmC;AAAA,MAU3DW,SAV2D,gBAU3DA,SAV2D;;AAYnE,MAAMC,iBAAiB,GAAGf,WAAW,CAAEH,QAAQ,CAAEiB,SAAF,EAAa,EAAb,CAAV,EAA6B,CACjEA,SADiE,CAA7B,CAArC;AAIAnB,EAAAA,cAAc,CACbK,WAAW,CAAE,YAAM;AAClBW,IAAAA,2BAA2B,CAAE,YAAM;AAClC,UAAKJ,UAAU,CAACS,SAAX,EAAL,EAA8B;AAC7BJ,QAAAA,gCAAgC,CAAE,IAAF,CAAhC;AACAL,QAAAA,UAAU,CAACU,MAAX;AACA,eAAO,IAAP;AACA;;AACDN,MAAAA,2BAA2B,CAAE,IAAF,CAA3B;AACA,aAAO,KAAP;AACA,KAR0B,CAA3B;;AASA,QAAKL,UAAL,EAAkB;AACjBQ,MAAAA,SAAS,CAAE,MAAF,CAAT;AACAD,MAAAA,eAAe,CAAE,IAAF,CAAf;AACA,KAHD,MAGO,IAAKL,SAAS,CAACU,OAAV,CAAkBT,SAAlB,KAAgC,CAArC,EAAyC;AAC/CI,MAAAA,eAAe,CAAE,KAAF,CAAf;AACAC,MAAAA,SAAS,CAAEN,SAAS,CAACU,OAAV,CAAkBT,SAApB,CAAT;AACA;;AACD,WAAO,YAAM,CAAE,CAAf;AACA,GAlBU,EAkBR,CAAEK,SAAF,CAlBQ,CADE,CAAd;;AAqBA,MAAMK,QAAQ,GAAG,SAAXA,QAAW,QAAuB;AAAA,QAAnBC,WAAmB,SAAnBA,WAAmB;;AACvC,QAAKd,UAAL,EAAkB;AACjB;AACA;;AAHsC,QAI/Be,MAJ+B,GAIpBD,WAAW,CAACE,MAJQ,CAI/BD,MAJ+B;;AAMvC,QAAKb,SAAS,CAACU,OAAV,CAAkBT,SAAlB,KAAgCY,MAAhC,IAA0CX,SAA/C,EAA2D;AAC1DF,MAAAA,SAAS,CAACU,OAAV,CAAkBT,SAAlB,GAA8BY,MAA9B;AACAN,MAAAA,iBAAiB,CAAEM,MAAF,CAAjB;AACA;AACD,GAVD;;AAYA,SAAOnB,OAAO,CAAE,YAAM;AACrB,WAAO,cAAC,IAAD;AAAM,MAAA,QAAQ,EAAGiB;AAAjB,OAA8Bd,QAA9B,CAAP;AACA,GAFa,EAEX,CAAEA,QAAF,EAAYK,SAAZ,CAFW,CAAd;AAGA,CApDD;;AAsDA,eAAeN,2BAAf","sourcesContent":["/**\n * External dependencies\n */\nimport {\n\tuseIsFocused,\n\tuseNavigation,\n\tuseFocusEffect,\n} from '@react-navigation/native';\nimport { View } from 'react-native';\nimport { debounce } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { BottomSheetContext } from '@wordpress/components';\n\nimport { useRef, useCallback, useContext, useMemo } from '@wordpress/element';\n\n/**\n * Internal dependencies\n */\nimport { BottomSheetNavigationContext } from './bottom-sheet-navigation-context';\n\nconst BottomSheetNavigationScreen = ( { children, fullScreen } ) => {\n\tconst navigation = useNavigation();\n\tconst heightRef = useRef( { maxHeight: 0 } );\n\tconst isFocused = useIsFocused();\n\tconst {\n\t\tonHandleHardwareButtonPress,\n\t\tshouldEnableBottomSheetMaxHeight,\n\t\tsetIsFullScreen,\n\t} = useContext( BottomSheetContext );\n\n\tconst { setHeight } = useContext( BottomSheetNavigationContext );\n\n\tconst setHeightDebounce = useCallback( debounce( setHeight, 10 ), [\n\t\tsetHeight,\n\t] );\n\n\tuseFocusEffect(\n\t\tuseCallback( () => {\n\t\t\tonHandleHardwareButtonPress( () => {\n\t\t\t\tif ( navigation.canGoBack() ) {\n\t\t\t\t\tshouldEnableBottomSheetMaxHeight( true );\n\t\t\t\t\tnavigation.goBack();\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\tonHandleHardwareButtonPress( null );\n\t\t\t\treturn false;\n\t\t\t} );\n\t\t\tif ( fullScreen ) {\n\t\t\t\tsetHeight( '100%' );\n\t\t\t\tsetIsFullScreen( true );\n\t\t\t} else if ( heightRef.current.maxHeight !== 0 ) {\n\t\t\t\tsetIsFullScreen( false );\n\t\t\t\tsetHeight( heightRef.current.maxHeight );\n\t\t\t}\n\t\t\treturn () => {};\n\t\t}, [ setHeight ] )\n\t);\n\tconst onLayout = ( { nativeEvent } ) => {\n\t\tif ( fullScreen ) {\n\t\t\treturn;\n\t\t}\n\t\tconst { height } = nativeEvent.layout;\n\n\t\tif ( heightRef.current.maxHeight !== height && isFocused ) {\n\t\t\theightRef.current.maxHeight = height;\n\t\t\tsetHeightDebounce( height );\n\t\t}\n\t};\n\n\treturn useMemo( () => {\n\t\treturn <View onLayout={ onLayout }>{ children }</View>;\n\t}, [ children, isFocused ] );\n};\n\nexport default BottomSheetNavigationScreen;\n"]}