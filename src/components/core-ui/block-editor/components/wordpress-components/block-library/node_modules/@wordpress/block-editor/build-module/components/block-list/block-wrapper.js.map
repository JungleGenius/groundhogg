{"version":3,"sources":["@wordpress/block-editor/src/components/block-list/block-wrapper.js"],"names":["classnames","first","last","omit","useRef","useEffect","useState","useContext","forwardRef","focus","isTextField","placeCaretAtHorizontalEdge","ENTER","BACKSPACE","DELETE","__","sprintf","useSelect","useDispatch","deprecated","isInsideRootBlock","useMovingAnimation","Context","SetBlockNodes","BlockListBlockContext","ELEMENTS","useBlockWrapperProps","props","__unstableIsHtml","fallbackRef","ref","onSelectionStart","setBlockNodes","clientId","rootClientId","isSelected","isFirstMultiSelected","isLastMultiSelected","isPartOfMultiSelection","enableAnimation","index","className","name","mode","blockTitle","wrapperProps","select","getSelectedBlocksInitialCaretPosition","_isMultiSelecting","isMultiSelecting","_isNavigationMode","isNavigationMode","shouldFocusFirstElement","initialPosition","undefined","insertDefaultBlock","removeBlock","isHovered","setHovered","node","current","nodes","blockLabel","focusTabbable","ownerDocument","activeElement","textInputs","tabbable","find","filter","closest","isReverse","target","onKeyDown","event","keyCode","preventDefault","onMouseLeave","buttons","addEventListener","removeEventListener","onMouseOver","defaultPrevented","onMouseOut","htmlSuffix","id","tabIndex","role","style","BlockComponent","children","tagName","TagName","alternative","blockWrapperProps","ExtendedBlockComponent","reduce","acc","element","Block"],"mappings":";;;;;;;;;;AAAA;;;AAGA,OAAOA,UAAP,MAAuB,YAAvB;AACA,SAASC,KAAT,EAAgBC,IAAhB,EAAsBC,IAAtB,QAAkC,QAAlC;AAEA;;;;AAGA,SACCC,MADD,EAECC,SAFD,EAGCC,QAHD,EAICC,UAJD,EAKCC,UALD,QAMO,oBANP;AAOA,SAASC,KAAT,EAAgBC,WAAhB,EAA6BC,0BAA7B,QAA+D,gBAA/D;AACA,SAASC,KAAT,EAAgBC,SAAhB,EAA2BC,MAA3B,QAAyC,qBAAzC;AACA,SAASC,EAAT,EAAaC,OAAb,QAA4B,iBAA5B;AACA,SAASC,SAAT,EAAoBC,WAApB,QAAuC,iBAAvC;AACA,OAAOC,UAAP,MAAuB,uBAAvB;AAEA;;;;AAGA,SAASC,iBAAT,QAAkC,iBAAlC;AACA,OAAOC,kBAAP,MAA+B,yBAA/B;AACA,SAASC,OAAT,EAAkBC,aAAlB,QAAuC,kBAAvC;AACA,SAASC,qBAAT,QAAsC,SAAtC;AACA,OAAOC,QAAP,MAAqB,0BAArB;AAEA;;;;;;;;;;;;;;;;AAeA,OAAO,SAASC,oBAAT,GAAuE;AAAA,MAAxCC,KAAwC,uEAAhC,EAAgC;;AAAA,iFAAL,EAAK;AAAA,MAA1BC,gBAA0B,QAA1BA,gBAA0B;;AAC7E,MAAMC,WAAW,GAAGzB,MAAM,EAA1B;AACA,MAAM0B,GAAG,GAAGH,KAAK,CAACG,GAAN,IAAaD,WAAzB;AACA,MAAME,gBAAgB,GAAGxB,UAAU,CAAEe,OAAF,CAAnC;AACA,MAAMU,aAAa,GAAGzB,UAAU,CAAEgB,aAAF,CAAhC;;AAJ6E,oBAmBzEhB,UAAU,CAAEiB,qBAAF,CAnB+D;AAAA,MAM5ES,QAN4E,eAM5EA,QAN4E;AAAA,MAO5EC,YAP4E,eAO5EA,YAP4E;AAAA,MAQ5EC,UAR4E,eAQ5EA,UAR4E;AAAA,MAS5EC,oBAT4E,eAS5EA,oBAT4E;AAAA,MAU5EC,mBAV4E,eAU5EA,mBAV4E;AAAA,MAW5EC,sBAX4E,eAW5EA,sBAX4E;AAAA,MAY5EC,eAZ4E,eAY5EA,eAZ4E;AAAA,MAa5EC,KAb4E,eAa5EA,KAb4E;AAAA,MAc5EC,SAd4E,eAc5EA,SAd4E;AAAA,MAe5EC,IAf4E,eAe5EA,IAf4E;AAAA,MAgB5EC,IAhB4E,eAgB5EA,IAhB4E;AAAA,MAiB5EC,UAjB4E,eAiB5EA,UAjB4E;AAAA,0CAkB5EC,YAlB4E;AAAA,MAkB5EA,YAlB4E,sCAkB7D,EAlB6D;;AAAA,mBAwBzE5B,SAAS,CACZ,UAAE6B,MAAF,EAAc;AAAA,kBAKTA,MAAM,CAAE,mBAAF,CALG;AAAA,QAEZC,qCAFY,WAEZA,qCAFY;AAAA,QAGMC,iBAHN,WAGZC,gBAHY;AAAA,QAIMC,iBAJN,WAIZC,gBAJY;;AAOb,WAAO;AACNC,MAAAA,uBAAuB,EACtBjB,UAAU,IACV,CAAEa,iBAAiB,EADnB,IAEA,CAAEE,iBAAiB,EAJd;AAKNG,MAAAA,eAAe,EAAElB,UAAU,GACxBY,qCAAqC,EADb,GAExBO,SAPG;AAQNH,MAAAA,gBAAgB,EAAED;AARZ,KAAP;AAUA,GAlBW,EAmBZ,CAAEf,UAAF,CAnBY,CAxBgE;AAAA,MAqB5EkB,eArB4E,cAqB5EA,eArB4E;AAAA,MAsB5ED,uBAtB4E,cAsB5EA,uBAtB4E;AAAA,MAuB5ED,gBAvB4E,cAuB5EA,gBAvB4E;;AAAA,qBA6CjCjC,WAAW,CACtD,mBADsD,CA7CsB;AAAA,MA6CrEqC,kBA7CqE,gBA6CrEA,kBA7CqE;AAAA,MA6CjDC,WA7CiD,gBA6CjDA,WA7CiD;;AAAA,kBAgD3ClD,QAAQ,CAAE,KAAF,CAhDmC;AAAA;AAAA,MAgDrEmD,SAhDqE;AAAA,MAgD1DC,UAhD0D,kBAkD7E;AACA;AACA;AACA;;;AACArD,EAAAA,SAAS,CAAE,YAAM;AAChB,QAAK8B,UAAU,IAAIC,oBAAd,IAAsCC,mBAA3C,EAAiE;AAChE,UAAMsB,IAAI,GAAG7B,GAAG,CAAC8B,OAAjB;AACA5B,MAAAA,aAAa,CAAE,UAAE6B,KAAF;AAAA,+CACXA,KADW,2BAEZ5B,QAFY,EAEA0B,IAFA;AAAA,OAAF,CAAb;AAIA,aAAO,YAAM;AACZ3B,QAAAA,aAAa,CAAE,UAAE6B,KAAF;AAAA,iBAAa1D,IAAI,CAAE0D,KAAF,EAAS5B,QAAT,CAAjB;AAAA,SAAF,CAAb;AACA,OAFD;AAGA;AACD,GAXQ,EAWN,CAAEE,UAAF,EAAcC,oBAAd,EAAoCC,mBAApC,CAXM,CAAT,CAtD6E,CAmE7E;AACA;AACA;;AACAhC,EAAAA,SAAS,CAAE,YAAM;AAChB,QAAMsD,IAAI,GAAG7B,GAAG,CAAC8B,OAAjB;AACA5B,IAAAA,aAAa,CAAE,UAAE6B,KAAF,EAAa;AAC3B,UAAK,CAAEA,KAAK,CAAE5B,QAAF,CAAP,IAAuB4B,KAAK,CAAE5B,QAAF,CAAL,KAAsB0B,IAAlD,EAAyD;AACxD,eAAOE,KAAP;AACA;;AAED,6CAAYA,KAAZ,2BAAqB5B,QAArB,EAAiC0B,IAAjC;AACA,KANY,CAAb;AAOA,GATQ,CAAT,CAtE6E,CAiF7E;;AACA,MAAMG,UAAU,GAAG9C,OAAO,CAAED,EAAE,CAAE,WAAF,CAAJ,EAAqB6B,UAArB,CAA1B,CAlF6E,CAoF7E;;AAEA;;;;AAGA,MAAMmB,aAAa,GAAG,SAAhBA,aAAgB,GAAM;AAAA,QACnBC,aADmB,GACDlC,GAAG,CAAC8B,OADH,CACnBI,aADmB,EAG3B;AACA;AACA;AACA;;AACA,QACCA,aAAa,CAACC,aAAd,IACA7C,iBAAiB,CAAEU,GAAG,CAAC8B,OAAN,EAAeI,aAAa,CAACC,aAA7B,CAFlB,EAGE;AACD;AACA,KAZ0B,CAc3B;;;AACA,QAAMC,UAAU,GAAGzD,KAAK,CAAC0D,QAAN,CAAeC,IAAf,CAAqBtC,GAAG,CAAC8B,OAAzB,EAAmCS,MAAnC,CAClB,UAAEV,IAAF;AAAA,aACCjD,WAAW,CAAEiD,IAAF,CAAX,IACA;AACAvC,MAAAA,iBAAiB,CAAEU,GAAG,CAAC8B,OAAN,EAAeD,IAAf,CAFjB,IAGA,CAAEA,IAAI,CAACW,OAAL,CAAc,sBAAd,CAJH;AAAA,KADkB,CAAnB,CAf2B,CAuB3B;AACA;;AACA,QAAMC,SAAS,GAAG,CAAC,CAAD,KAAOlB,eAAzB;AACA,QAAMmB,MAAM,GACX,CAAED,SAAS,GAAGrE,IAAH,GAAUD,KAArB,EAA8BiE,UAA9B,KAA8CpC,GAAG,CAAC8B,OADnD;AAGAjD,IAAAA,0BAA0B,CAAE6D,MAAF,EAAUD,SAAV,CAA1B;AACA,GA9BD;;AAgCAlE,EAAAA,SAAS,CAAE,YAAM;AAChB,QAAK+C,uBAAL,EAA+B;AAC9BW,MAAAA,aAAa;AACb;AACD,GAJQ,EAIN,CAAEX,uBAAF,CAJM,CAAT,CAzH6E,CA+H7E;;AACA/B,EAAAA,kBAAkB,CACjBS,GADiB,EAEjBK,UAAU,IAAIG,sBAFG,EAGjBH,UAAU,IAAIC,oBAHG,EAIjBG,eAJiB,EAKjBC,KALiB,CAAlB;AAQAnC,EAAAA,SAAS,CAAE,YAAM;AAChB,QAAK,CAAE8B,UAAP,EAAoB;AACnB;AACA;AAED;;;;;;;;;;;AASA,aAASsC,SAAT,CAAoBC,KAApB,EAA4B;AAAA,UACnBC,OADmB,GACCD,KADD,CACnBC,OADmB;AAAA,UACVH,MADU,GACCE,KADD,CACVF,MADU;;AAG3B,UACCG,OAAO,KAAK/D,KAAZ,IACA+D,OAAO,KAAK9D,SADZ,IAEA8D,OAAO,KAAK7D,MAHb,EAIE;AACD;AACA;;AAED,UAAK0D,MAAM,KAAK1C,GAAG,CAAC8B,OAAf,IAA0BlD,WAAW,CAAE8D,MAAF,CAA1C,EAAuD;AACtD;AACA;;AAEDE,MAAAA,KAAK,CAACE,cAAN;;AAEA,UAAKD,OAAO,KAAK/D,KAAjB,EAAyB;AACxB2C,QAAAA,kBAAkB,CAAE,EAAF,EAAMrB,YAAN,EAAoBM,KAAK,GAAG,CAA5B,CAAlB;AACA,OAFD,MAEO;AACNgB,QAAAA,WAAW,CAAEvB,QAAF,CAAX;AACA;AACD;;AAED,aAAS4C,YAAT,QAAqC;AAAA,UAAZC,OAAY,SAAZA,OAAY;;AACpC;AACA;AACA,UAAKA,OAAO,KAAK,CAAjB,EAAqB;AACpB/C,QAAAA,gBAAgB,CAAEE,QAAF,CAAhB;AACA;AACD;;AAEDH,IAAAA,GAAG,CAAC8B,OAAJ,CAAYmB,gBAAZ,CAA8B,SAA9B,EAAyCN,SAAzC;AACA3C,IAAAA,GAAG,CAAC8B,OAAJ,CAAYmB,gBAAZ,CAA8B,YAA9B,EAA4CF,YAA5C;AAEA,WAAO,YAAM;AACZ/C,MAAAA,GAAG,CAAC8B,OAAJ,CAAYoB,mBAAZ,CAAiC,YAAjC,EAA+CH,YAA/C;AACA/C,MAAAA,GAAG,CAAC8B,OAAJ,CAAYoB,mBAAZ,CAAiC,SAAjC,EAA4CP,SAA5C;AACA,KAHD;AAIA,GArDQ,EAqDN,CAAEtC,UAAF,EAAcJ,gBAAd,EAAgCwB,kBAAhC,EAAoDC,WAApD,CArDM,CAAT;AAuDAnD,EAAAA,SAAS,CAAE,YAAM;AAChB,QAAK,CAAE8C,gBAAP,EAA0B;AACzB;AACA;;AAED,aAAS8B,WAAT,CAAsBP,KAAtB,EAA8B;AAC7B,UAAKA,KAAK,CAACQ,gBAAX,EAA8B;AAC7B;AACA;;AAEDR,MAAAA,KAAK,CAACE,cAAN;;AAEA,UAAKnB,SAAL,EAAiB;AAChB;AACA;;AAEDC,MAAAA,UAAU,CAAE,IAAF,CAAV;AACA;;AAED,aAASyB,UAAT,CAAqBT,KAArB,EAA6B;AAC5B,UAAKA,KAAK,CAACQ,gBAAX,EAA8B;AAC7B;AACA;;AAEDR,MAAAA,KAAK,CAACE,cAAN;;AAEA,UAAK,CAAEnB,SAAP,EAAmB;AAClB;AACA;;AAEDC,MAAAA,UAAU,CAAE,KAAF,CAAV;AACA;;AAED5B,IAAAA,GAAG,CAAC8B,OAAJ,CAAYmB,gBAAZ,CAA8B,WAA9B,EAA2CE,WAA3C;AACAnD,IAAAA,GAAG,CAAC8B,OAAJ,CAAYmB,gBAAZ,CAA8B,UAA9B,EAA0CI,UAA1C;AAEA,WAAO,YAAM;AACZrD,MAAAA,GAAG,CAAC8B,OAAJ,CAAYoB,mBAAZ,CAAiC,WAAjC,EAA8CC,WAA9C;AACAnD,MAAAA,GAAG,CAAC8B,OAAJ,CAAYoB,mBAAZ,CAAiC,UAAjC,EAA6CG,UAA7C;AACA,KAHD;AAIA,GAxCQ,EAwCN,CAAEhC,gBAAF,EAAoBM,SAApB,EAA+BC,UAA/B,CAxCM,CAAT;AA0CA,MAAM0B,UAAU,GAAGzC,IAAI,KAAK,MAAT,IAAmB,CAAEf,gBAArB,GAAwC,SAAxC,GAAoD,EAAvE;AAEA,uDACIiB,YADJ,GAEIlB,KAFJ;AAGCG,IAAAA,GAAG,EAAHA,GAHD;AAICuD,IAAAA,EAAE,kBAAYpD,QAAZ,SAAyBmD,UAAzB,CAJH;AAKCE,IAAAA,QAAQ,EAAE,CALX;AAMCC,IAAAA,IAAI,EAAE,OANP;AAOC,kBAAczB,UAPf;AAQC,kBAAc7B,QARf;AASC,iBAAaS,IATd;AAUC,kBAAcE,UAVf;AAWCH,IAAAA,SAAS,EAAEzC,UAAU,CACpByC,SADoB,EAEpBd,KAAK,CAACc,SAFc,EAGpBI,YAAY,CAACJ,SAHO,EAIpB;AAAE,oBAAcgB;AAAhB,KAJoB,CAXtB;AAiBC+B,IAAAA,KAAK,kCAAO3C,YAAY,CAAC2C,KAApB,GAA8B7D,KAAK,CAAC6D,KAApC;AAjBN;AAmBA;AAED,IAAMC,cAAc,GAAGjF,UAAU,CAChC,iBAAoDsB,GAApD,EAA6D;AAAA,MAAzD4D,QAAyD,SAAzDA,QAAyD;AAAA,4BAA/CC,OAA+C;AAAA,MAAtCC,OAAsC,8BAA5B,KAA4B;AAAA,MAAlBjE,KAAkB;;AAC5DR,EAAAA,UAAU,CAAE,oCAAF,EAAwC;AACjD0E,IAAAA,WAAW,EAAE;AADoC,GAAxC,CAAV;AAGA,MAAMC,iBAAiB,GAAGpE,oBAAoB,iCAAOC,KAAP;AAAcG,IAAAA,GAAG,EAAHA;AAAd,KAA9C;AACA,SAAO,cAAC,OAAD,EAAcgE,iBAAd,EAAoCJ,QAApC,CAAP;AACA,CAP+B,CAAjC;AAUA,IAAMK,sBAAsB,GAAGtE,QAAQ,CAACuE,MAAT,CAAiB,UAAEC,GAAF,EAAOC,OAAP,EAAoB;AACnED,EAAAA,GAAG,CAAEC,OAAF,CAAH,GAAiB1F,UAAU,CAAE,UAAEmB,KAAF,EAASG,GAAT,EAAkB;AAC9C,WAAO,cAAC,cAAD,eAAqBH,KAArB;AAA6B,MAAA,GAAG,EAAGG,GAAnC;AAAyC,MAAA,OAAO,EAAGoE;AAAnD,OAAP;AACA,GAF0B,CAA3B;AAGA,SAAOD,GAAP;AACA,CAL8B,EAK5BR,cAL4B,CAA/B;AAOA,OAAO,IAAMU,KAAK,GAAGJ,sBAAd","sourcesContent":["/**\n * External dependencies\n */\nimport classnames from 'classnames';\nimport { first, last, omit } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport {\n\tuseRef,\n\tuseEffect,\n\tuseState,\n\tuseContext,\n\tforwardRef,\n} from '@wordpress/element';\nimport { focus, isTextField, placeCaretAtHorizontalEdge } from '@wordpress/dom';\nimport { ENTER, BACKSPACE, DELETE } from '@wordpress/keycodes';\nimport { __, sprintf } from '@wordpress/i18n';\nimport { useSelect, useDispatch } from '@wordpress/data';\nimport deprecated from '@wordpress/deprecated';\n\n/**\n * Internal dependencies\n */\nimport { isInsideRootBlock } from '../../utils/dom';\nimport useMovingAnimation from '../use-moving-animation';\nimport { Context, SetBlockNodes } from './root-container';\nimport { BlockListBlockContext } from './block';\nimport ELEMENTS from './block-wrapper-elements';\n\n/**\n * This hook is used to lighly mark an element as a block element. Call this\n * hook and pass the returned props to the element to mark as a block. If you\n * define a ref for the element, it is important to pass the ref to this hook,\n * which the hooks in turn will pass to the component through the props it\n * returns. Optionally, you can also pass any other props through this hook, and\n * they will be merged and returned.\n *\n * @param {Object}  props   Optional. Props to pass to the element. Must contain\n *                          the ref if one is defined.\n * @param {Object}  options Options for internal use only.\n * @param {boolean} options.__unstableIsHtml\n *\n * @return {Object} Props to pass to the element to mark as a block.\n */\nexport function useBlockWrapperProps( props = {}, { __unstableIsHtml } = {} ) {\n\tconst fallbackRef = useRef();\n\tconst ref = props.ref || fallbackRef;\n\tconst onSelectionStart = useContext( Context );\n\tconst setBlockNodes = useContext( SetBlockNodes );\n\tconst {\n\t\tclientId,\n\t\trootClientId,\n\t\tisSelected,\n\t\tisFirstMultiSelected,\n\t\tisLastMultiSelected,\n\t\tisPartOfMultiSelection,\n\t\tenableAnimation,\n\t\tindex,\n\t\tclassName,\n\t\tname,\n\t\tmode,\n\t\tblockTitle,\n\t\twrapperProps = {},\n\t} = useContext( BlockListBlockContext );\n\tconst {\n\t\tinitialPosition,\n\t\tshouldFocusFirstElement,\n\t\tisNavigationMode,\n\t} = useSelect(\n\t\t( select ) => {\n\t\t\tconst {\n\t\t\t\tgetSelectedBlocksInitialCaretPosition,\n\t\t\t\tisMultiSelecting: _isMultiSelecting,\n\t\t\t\tisNavigationMode: _isNavigationMode,\n\t\t\t} = select( 'core/block-editor' );\n\n\t\t\treturn {\n\t\t\t\tshouldFocusFirstElement:\n\t\t\t\t\tisSelected &&\n\t\t\t\t\t! _isMultiSelecting() &&\n\t\t\t\t\t! _isNavigationMode(),\n\t\t\t\tinitialPosition: isSelected\n\t\t\t\t\t? getSelectedBlocksInitialCaretPosition()\n\t\t\t\t\t: undefined,\n\t\t\t\tisNavigationMode: _isNavigationMode,\n\t\t\t};\n\t\t},\n\t\t[ isSelected ]\n\t);\n\tconst { insertDefaultBlock, removeBlock } = useDispatch(\n\t\t'core/block-editor'\n\t);\n\tconst [ isHovered, setHovered ] = useState( false );\n\n\t// Provide the selected node, or the first and last nodes of a multi-\n\t// selection, so it can be used to position the contextual block toolbar.\n\t// We only provide what is necessary, and remove the nodes again when they\n\t// are no longer selected.\n\tuseEffect( () => {\n\t\tif ( isSelected || isFirstMultiSelected || isLastMultiSelected ) {\n\t\t\tconst node = ref.current;\n\t\t\tsetBlockNodes( ( nodes ) => ( {\n\t\t\t\t...nodes,\n\t\t\t\t[ clientId ]: node,\n\t\t\t} ) );\n\t\t\treturn () => {\n\t\t\t\tsetBlockNodes( ( nodes ) => omit( nodes, clientId ) );\n\t\t\t};\n\t\t}\n\t}, [ isSelected, isFirstMultiSelected, isLastMultiSelected ] );\n\n\t// Set new block node if it changes.\n\t// This effect should happen on every render, so no dependencies should be\n\t// added.\n\tuseEffect( () => {\n\t\tconst node = ref.current;\n\t\tsetBlockNodes( ( nodes ) => {\n\t\t\tif ( ! nodes[ clientId ] || nodes[ clientId ] === node ) {\n\t\t\t\treturn nodes;\n\t\t\t}\n\n\t\t\treturn { ...nodes, [ clientId ]: node };\n\t\t} );\n\t} );\n\n\t// translators: %s: Type of block (i.e. Text, Image etc)\n\tconst blockLabel = sprintf( __( 'Block: %s' ), blockTitle );\n\n\t// Handing the focus of the block on creation and update\n\n\t/**\n\t * When a block becomes selected, transition focus to an inner tabbable.\n\t */\n\tconst focusTabbable = () => {\n\t\tconst { ownerDocument } = ref.current;\n\n\t\t// Focus is captured by the wrapper node, so while focus transition\n\t\t// should only consider tabbables within editable display, since it\n\t\t// may be the wrapper itself or a side control which triggered the\n\t\t// focus event, don't unnecessary transition to an inner tabbable.\n\t\tif (\n\t\t\townerDocument.activeElement &&\n\t\t\tisInsideRootBlock( ref.current, ownerDocument.activeElement )\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Find all tabbables within node.\n\t\tconst textInputs = focus.tabbable.find( ref.current ).filter(\n\t\t\t( node ) =>\n\t\t\t\tisTextField( node ) &&\n\t\t\t\t// Exclude inner blocks and block appenders\n\t\t\t\tisInsideRootBlock( ref.current, node ) &&\n\t\t\t\t! node.closest( '.block-list-appender' )\n\t\t);\n\n\t\t// If reversed (e.g. merge via backspace), use the last in the set of\n\t\t// tabbables.\n\t\tconst isReverse = -1 === initialPosition;\n\t\tconst target =\n\t\t\t( isReverse ? last : first )( textInputs ) || ref.current;\n\n\t\tplaceCaretAtHorizontalEdge( target, isReverse );\n\t};\n\n\tuseEffect( () => {\n\t\tif ( shouldFocusFirstElement ) {\n\t\t\tfocusTabbable();\n\t\t}\n\t}, [ shouldFocusFirstElement ] );\n\n\t// Block Reordering animation\n\tuseMovingAnimation(\n\t\tref,\n\t\tisSelected || isPartOfMultiSelection,\n\t\tisSelected || isFirstMultiSelected,\n\t\tenableAnimation,\n\t\tindex\n\t);\n\n\tuseEffect( () => {\n\t\tif ( ! isSelected ) {\n\t\t\treturn;\n\t\t}\n\n\t\t/**\n\t\t * Interprets keydown event intent to remove or insert after block if\n\t\t * key event occurs on wrapper node. This can occur when the block has\n\t\t * no text fields of its own, particularly after initial insertion, to\n\t\t * allow for easy deletion and continuous writing flow to add additional\n\t\t * content.\n\t\t *\n\t\t * @param {KeyboardEvent} event Keydown event.\n\t\t */\n\t\tfunction onKeyDown( event ) {\n\t\t\tconst { keyCode, target } = event;\n\n\t\t\tif (\n\t\t\t\tkeyCode !== ENTER &&\n\t\t\t\tkeyCode !== BACKSPACE &&\n\t\t\t\tkeyCode !== DELETE\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif ( target !== ref.current || isTextField( target ) ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tevent.preventDefault();\n\n\t\t\tif ( keyCode === ENTER ) {\n\t\t\t\tinsertDefaultBlock( {}, rootClientId, index + 1 );\n\t\t\t} else {\n\t\t\t\tremoveBlock( clientId );\n\t\t\t}\n\t\t}\n\n\t\tfunction onMouseLeave( { buttons } ) {\n\t\t\t// The primary button must be pressed to initiate selection.\n\t\t\t// See https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent/buttons\n\t\t\tif ( buttons === 1 ) {\n\t\t\t\tonSelectionStart( clientId );\n\t\t\t}\n\t\t}\n\n\t\tref.current.addEventListener( 'keydown', onKeyDown );\n\t\tref.current.addEventListener( 'mouseleave', onMouseLeave );\n\n\t\treturn () => {\n\t\t\tref.current.removeEventListener( 'mouseleave', onMouseLeave );\n\t\t\tref.current.removeEventListener( 'keydown', onKeyDown );\n\t\t};\n\t}, [ isSelected, onSelectionStart, insertDefaultBlock, removeBlock ] );\n\n\tuseEffect( () => {\n\t\tif ( ! isNavigationMode ) {\n\t\t\treturn;\n\t\t}\n\n\t\tfunction onMouseOver( event ) {\n\t\t\tif ( event.defaultPrevented ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tevent.preventDefault();\n\n\t\t\tif ( isHovered ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tsetHovered( true );\n\t\t}\n\n\t\tfunction onMouseOut( event ) {\n\t\t\tif ( event.defaultPrevented ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tevent.preventDefault();\n\n\t\t\tif ( ! isHovered ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tsetHovered( false );\n\t\t}\n\n\t\tref.current.addEventListener( 'mouseover', onMouseOver );\n\t\tref.current.addEventListener( 'mouseout', onMouseOut );\n\n\t\treturn () => {\n\t\t\tref.current.removeEventListener( 'mouseover', onMouseOver );\n\t\t\tref.current.removeEventListener( 'mouseout', onMouseOut );\n\t\t};\n\t}, [ isNavigationMode, isHovered, setHovered ] );\n\n\tconst htmlSuffix = mode === 'html' && ! __unstableIsHtml ? '-visual' : '';\n\n\treturn {\n\t\t...wrapperProps,\n\t\t...props,\n\t\tref,\n\t\tid: `block-${ clientId }${ htmlSuffix }`,\n\t\ttabIndex: 0,\n\t\trole: 'group',\n\t\t'aria-label': blockLabel,\n\t\t'data-block': clientId,\n\t\t'data-type': name,\n\t\t'data-title': blockTitle,\n\t\tclassName: classnames(\n\t\t\tclassName,\n\t\t\tprops.className,\n\t\t\twrapperProps.className,\n\t\t\t{ 'is-hovered': isHovered }\n\t\t),\n\t\tstyle: { ...wrapperProps.style, ...props.style },\n\t};\n}\n\nconst BlockComponent = forwardRef(\n\t( { children, tagName: TagName = 'div', ...props }, ref ) => {\n\t\tdeprecated( 'wp.blockEditor.__experimentalBlock', {\n\t\t\talternative: 'wp.blockEditor.__experimentalUseBlockWrapperProps',\n\t\t} );\n\t\tconst blockWrapperProps = useBlockWrapperProps( { ...props, ref } );\n\t\treturn <TagName { ...blockWrapperProps }>{ children }</TagName>;\n\t}\n);\n\nconst ExtendedBlockComponent = ELEMENTS.reduce( ( acc, element ) => {\n\tacc[ element ] = forwardRef( ( props, ref ) => {\n\t\treturn <BlockComponent { ...props } ref={ ref } tagName={ element } />;\n\t} );\n\treturn acc;\n}, BlockComponent );\n\nexport const Block = ExtendedBlockComponent;\n"]}